{
    "props": {
        "pageProps": {
            "query": {
                "id": "158a2e3e2fc64af68585a7350c43980a"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 82247,
                "outId": "158a2e3e2fc64af68585a7350c43980a",
                "articleOutId": "158a2e3e2fc64af68585a7350c43980a",
                "html": "<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">在遗传学中，群体指的是一组具有共同遗传特征的个体，而个体则是指单个生物体。群体中的个体之间可以存在遗传交流和基因流动，这会导致群体中的基因频率发生变化。今天分享的笔记是群体进化与选择分析，包括Pi、Fst、TajimaD、XP-CLR的介绍和计算方法。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">首先，咱们都知道时间不会停止，也就意味着历史的车轮不会停止，自然界一直在不断地演化，不管是动物还是植物，都在不停的选择和分化。例如玉米小麦等植物，在很久以前可能发源于杂草，后来经过人的驯化，才改良为现在适宜栽培的品种。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\">什么是正选择？</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">正选择可以用自然选择来解释：假如一个基因或位点能够使个体有着更强的生存力，这样就会使个体的后代更多，如此一来，这个基因或位点在群体中就越来越多。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">举个例子：</strong>以前非洲大草原有短颈鹿，后来偶然的突变导致长颈鹿产生，由于长颈鹿能吃到更多的食物，有着更高的存活率，所以导致这个突变受到正选择。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\">负选择</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">如果群体中的某个个体出现一个致命的突变，从而使自己或者是后代从群体中被淘汰，这也导致群体中该位点的多态性的降低。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">举个例子：</strong>假如正常生长中的玉米群体中偶然发生了一个突变，导致水分吸收受阻，这种缺陷导致后代被淘汰，因此该突变位点的多态性会降低。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\">平衡选择</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">平衡选择指多个等位基因在一个群体的基因库中以高于遗传漂变预期的频率被保留，如杂合子优势。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\"><strong style=\"font-weight: bold; color: black;\">核酸多样性Pi</strong></span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">Pi指的是核苷酸多样性，Pi值越大说明核苷酸多样性越高。通常用于衡量群体内的核苷酸多样性，也可以用来推演进化关系，可以理解成先在群体内两两求Pi，再计算群体的均值,常用软件是vcftools。</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\">vcftools&nbsp;--vcf&nbsp;input.vcf&nbsp;--window-pi&nbsp;200000&nbsp;--window-pi-step&nbsp;100000&nbsp;--keep&nbsp;1.sample.list&nbsp;--out&nbsp;pi_window_1.sample.list<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;检查文件的行数</span><br>wc&nbsp;-l&nbsp;pi_window_1.sample.list.windowed.pi<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">批量计算Pi的脚本：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\"><span class=\"hljs-meta\" style=\"color: #643820; line-height: 26px;\">#!/bin/bash</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#定义所有以.txt结尾的sample.list文件</span><br>sample_files=(*.txt)<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#循环执行命令</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;sample&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">in</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[@]}</span>\"</span>;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#生成输出文件名</span><br>&nbsp;&nbsp;&nbsp;&nbsp;output=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"pi_window_<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample}</span>\"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#输出调试信息</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Running&nbsp;vcftools&nbsp;for&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>,output&nbsp;file:&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#确认文件存在</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">if</span>&nbsp;[&nbsp;!&nbsp;-f&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>\"</span>&nbsp;];<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Error:File&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>&nbsp;does&nbsp;not&nbsp;exist\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">continue</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">fi</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#运行vcftools命令</span><br>&nbsp;&nbsp;&nbsp;&nbsp;vcftools&nbsp;--vcf&nbsp;input.vcf&nbsp;--window-pi&nbsp;200000&nbsp;--window-pi-step&nbsp;100000&nbsp;--keep&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>\"</span>&nbsp;--out&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output</span>\"</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">done</span><br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">利用ggplot2画图的脚本：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\"><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;读取数据</span><br>pi_window_1&nbsp;&lt;-&nbsp;read.table(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"pi_window_1.sample.list.windowed.pi\"</span>,header&nbsp;=&nbsp;TRUE,sep&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"\\t\"</span>)<br>pi_window_2&nbsp;&lt;-&nbsp;read.table(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"pi_window_2.sample.list.windowed.pi\"</span>,header&nbsp;=&nbsp;TRUE,sep&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"\\t\"</span>)<br>pi_window_3&nbsp;&lt;-&nbsp;read.table(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"pi_window_3.sample.list.windowed.pi\"</span>,header&nbsp;=&nbsp;TRUE,sep&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"\\t\"</span>)<br>pi_window_1<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$Group</span>&nbsp;&lt;-&nbsp;1<br>pi_window_2<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$Group</span>&nbsp;&lt;-&nbsp;2<br>pi_window_3<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$Group</span>&nbsp;&lt;-&nbsp;3<br>df_plot_all&nbsp;&lt;-&nbsp;rbind(pi_window_1,pi_window_2,pi_window_3)<br><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;绘制结果</span><br>library(ggplot2)<br>p1&nbsp;&lt;-&nbsp;ggplot(df_plot_all)+<br>&nbsp;&nbsp;geom_smooth(aes(BIN_START,PI,color=as.factor(Group),group=Group),method&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"loess\"</span>,span =&nbsp;0.1,se&nbsp;=&nbsp;F,linewidth&nbsp;=&nbsp;1)+<br>&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;geom_smooth(aes(BIN_START,PI,color=as.factor(Group),group=Group),method&nbsp;=&nbsp;\"gam\",span =&nbsp;0.1,se&nbsp;=&nbsp;F,linewidth&nbsp;=&nbsp;1)+</span><br>&nbsp;&nbsp;scale_color_manual(values&nbsp;=&nbsp;c(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"red\"</span>,<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"green\"</span>,<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"blue\"</span>))+<br>&nbsp;&nbsp;xlab(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Physical&nbsp;Position\"</span>)+<br>&nbsp;&nbsp;ylab(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Pi\"</span>)+<br>&nbsp;&nbsp;theme_bw()+<br>&nbsp;&nbsp;theme(legend.position&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"right\"</span>)<br>&nbsp;&nbsp;<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;输出图片</span><br>ggsave(filename=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"pi_200kwindow_100kstep.pdf\"</span>,plot&nbsp;=&nbsp;p1,width&nbsp;=&nbsp;16,height&nbsp;=&nbsp;9)<br>p1<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\"><strong style=\"font-weight: bold; color: black;\">群体内选择检验TajimaD</strong></span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">Tajima's D是日本学者Tajima Fumio 1989年提出的一种统计检验方法，用于检验DNA序列在演化过程中是否遵循中性演化模型。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #f44336;\">D &gt; 0</code>: 平衡选择，突然收缩，稀有等位基因以低频率存在。<br> <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #f44336;\">D &lt; 0</code>: 经历瓶颈效应，随后群体扩张，稀有等位基因以高频率存在。<br> <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #f44336;\">D = 0</code>: 平衡演变，没有太大频率差异。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">计算方法：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\">vcftools&nbsp;--vcf&nbsp;input.vcf&nbsp;--TajimaD&nbsp;100000&nbsp;--keep&nbsp;1.sample.list&nbsp;--out&nbsp;TajimaD_1.sample.list<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">批量计算TajimaD的脚本：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\"><span class=\"hljs-meta\" style=\"color: #643820; line-height: 26px;\">#!/bin/bash</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#定义所有以.txt结尾的sample.list文件</span><br>sample_files=(*.txt)<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#循环执行命令</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;sample&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">in</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[@]}</span>\"</span>;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#生成输出文件名</span><br>&nbsp;&nbsp;&nbsp;&nbsp;output=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"TajimaD_<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample}</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#输出调试信息</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Running&nbsp;vcftools&nbsp;for&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>,output&nbsp;file:&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#确认文件存在</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">if</span>&nbsp;[&nbsp;!&nbsp;-f&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>\"</span>&nbsp;];<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Error:&nbsp;File&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>&nbsp;does&nbsp;not&nbsp;exist\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">continue</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">fi</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#运行vcftools&nbsp;命令</span><br>&nbsp;&nbsp;&nbsp;&nbsp;vcftools&nbsp;--vcf&nbsp;input.vcf&nbsp;--TajimaD&nbsp;100000&nbsp;--keep&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample</span>\"</span>&nbsp;--out&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output</span>\"</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">done</span><br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\"><strong style=\"font-weight: bold; color: black;\">群体间分歧度Fst</strong></span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">Fst叫固定分化指数，用于估计亚群间平均多态性大小与整个种群平均多态性大小的差异，反映的是群体结构的变化。Fst的取值范围是[0,1]</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">当Fst=1时，表明亚群间有着明显的种群分化，值越高表示分化程度越高。在中性进化条件下，Fst的大小主要取决于遗传漂变和迁移等因素的影响。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">假设种群中的某个等位基因对特定环境的适应度较高而经历适应性选择，那该基因的频率在种群中会升高，种群的分化水平增大，群体Fst升高。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">计算方法：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\">&nbsp;vcftools&nbsp;--vcf&nbsp;all_2229.vcf&nbsp;--fst-window-size&nbsp;200000&nbsp;--fst-window-step&nbsp;100000&nbsp;--weir-fst-pop&nbsp;1.sample.list&nbsp;--weir-fst-pop&nbsp;2.sample.list&nbsp;--out&nbsp;fst.1.sample.list.2.sample.list<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\"><strong style=\"font-weight: bold; color: black;\">批量计算Fst的脚本：</strong></p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\"><span class=\"hljs-meta\" style=\"color: #643820; line-height: 26px;\">#!/bin/bash</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#定义所有的sample.list文件</span><br>sample_files=(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"W.sample.list.txt\"</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"S.sample.list.txt\"</span>)<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#获取样本文件的数量</span><br>num_samples=<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${#sample_files[@]}</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#确保有足够的文件进行成对比较</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">if</span>&nbsp;((num_samples&nbsp;&lt;&nbsp;2));<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Error:&nbsp;Not&nbsp;enough&nbsp;sample&nbsp;files.At&nbsp;least&nbsp;two&nbsp;are&nbsp;required.\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">exit</span>&nbsp;1<br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">fi</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#循环执行命令，两两比较sample.list文件</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;((i=0;i&lt;num_samples;&nbsp;i++&nbsp;));<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;((j=i+1;j&lt;num_samples;&nbsp;j++&nbsp;));<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample1=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[i]}</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sample2=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[j]}</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#生成输出文件名</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"fst.<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample1%.sample.list.txt}</span>.<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample2%.sample.list.txt}</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#输出调试信息</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Running&nbsp;vcftools&nbsp;for&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample1</span>&nbsp;and&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample2</span>,output&nbsp;file:&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#确认文件存在</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">if</span>&nbsp;[&nbsp;!&nbsp;-f&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample1</span>\"</span>];<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Error:&nbsp;File&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample1</span>&nbsp;does&nbsp;not&nbsp;exist\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">continue</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">fi</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">if</span>&nbsp;[&nbsp;!&nbsp;-f&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample2</span>\"</span>&nbsp;];<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">then</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Error:&nbsp;File&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample2</span>&nbsp;does&nbsp;not&nbsp;exist\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">continue</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">fi</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#运行vcftools命令</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vcftools&nbsp;--vcf&nbsp;input.vcf&nbsp;--fst-window-size&nbsp;2000&nbsp;--fst-window-step&nbsp;1000&nbsp;--weir-fst-pop&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$sample1</span>\"</span>&nbsp;--weir-fst-pop&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"$$<br>&nbsp;&nbsp;&nbsp;&nbsp;done<br>done<br></span></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: #009688; padding-left: 12px; margin: 1em auto; font-size: 1.2em; border-left: 7px solid #009688;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\"><strong style=\"font-weight: bold; color: black;\">跨群体复合似然比检验XP-CLR</strong></span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">XP-CLR 是陈华老师等在 2010 年开发的方法，全称叫 the cross-population composite likelihood ratio test（跨群体复合似然比检验），是一种是基于选择扫荡（selective sweeep）的似然方法。</p> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">选择扫荡可以增加群体之间的遗传分化，导致等位基因频率偏离中性条件下的预期值。XP-CLR利用两个群体之间的多基因座等位基因频率差异（multilocus allele frequency differentiation）建立模型，使用布朗运动来模拟中性下的遗传漂移，并使用确定性模型来近似地对附近的单核苷酸多态性（SNPs）进行选择性扫描，以下是计算方法：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; background: #fff; color: black; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; border: 2px solid #d5ebe1; border-radius: 10px; padding: 10px;\"><span class=\"hljs-meta\" style=\"color: #643820; line-height: 26px;\">#!/bin/bash</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;定义样本文件数组</span><br>sample_files=(<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"1.sample.list.txt\"</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"2.sample.list.txt\"</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"3.sample.list.txt\"</span>)<br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;获取所有染色体编号</span><br>chromosomes=$(bcftools&nbsp;view&nbsp;-h&nbsp;input.vcf&nbsp;|&nbsp;grep&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">'^##contig'</span>&nbsp;|&nbsp;cut&nbsp;-d&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">'='</span>&nbsp;-f3&nbsp;|&nbsp;cut&nbsp;-d&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">','</span>&nbsp;-f1)<br><span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Chromosomes:&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$chromosomes</span>\"</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;定义输出目录</span><br>output_dir=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"./out\"</span><br>mkdir&nbsp;-p&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output_dir</span><br><span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;循环遍历样本文件两两组合</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;i&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">in</span>&nbsp;0&nbsp;1&nbsp;2;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;j&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">in</span>&nbsp;$(seq&nbsp;$((i+1))&nbsp;2);&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samplesA=<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[$i]}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samplesB=<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${sample_files[$j]}</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;获取无后缀样本名</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samplesA_name=$(basename&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesA%.sample.list.txt}</span>\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;samplesB_name=$(basename&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesB%.sample.list.txt}</span>\"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;定义组合编号</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;combo=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesA_name}</span><span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesB_name}</span>\"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;定义组合输出文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output_file=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${output_dir}</span>/chr_all_<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${combo}</span>.txt\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;循环遍历每个染色体，并运行&nbsp;xpclr，输出到临时文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">for</span>&nbsp;chr&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">in</span>&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$chromosomes</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">do</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"Running&nbsp;XPCLR&nbsp;for&nbsp;chromosome&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$chr</span>&nbsp;with&nbsp;samples&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesA_name}</span>&nbsp;and&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${samplesB_name}</span>...\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_output=<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${output_dir}</span>/temp_<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${chr}</span>_<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">${combo}</span>.txt\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xpclr&nbsp;--out&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$temp_output</span>\"</span>&nbsp;--format&nbsp;vcf&nbsp;--input&nbsp;input.vcf&nbsp;--samplesA&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$samplesA</span>&nbsp;--samplesB&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$samplesB</span>&nbsp;--size&nbsp;200000&nbsp;--step&nbsp;100000&nbsp;--chr&nbsp;<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$chr</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;将临时文件的内容追加到组合输出文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cat&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$temp_output</span>\"</span>&nbsp;&gt;&gt;&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$output_file</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #007400; line-height: 26px;\">#&nbsp;删除临时文件</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rm&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"<span class=\"hljs-variable\" style=\"color: #3F6E74; line-height: 26px;\">$temp_output</span>\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">done</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">done</span><br><span class=\"hljs-keyword\" style=\"color: #aa0d91; line-height: 26px;\">done</span><br><span class=\"hljs-built_in\" style=\"color: #5c2699; line-height: 26px;\">echo</span>&nbsp;<span class=\"hljs-string\" style=\"color: #c41a16; line-height: 26px;\">\"XPCLR&nbsp;analysis&nbsp;completed&nbsp;for&nbsp;all&nbsp;combinations&nbsp;and&nbsp;chromosomes.\"</span><br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"font-size: 16px; padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; text-align: justify; padding: 0px; letter-spacing: 1px; margin-bottom: 20px;\">以上就是今天分享的全部内容，如果对您有所帮助，欢迎转发收藏。</p>",
                "title": "群体遗传进化Pi和Fst、XP-CLR计算方法",
                "categoryId": 1,
                "categoryName": "后端",
                "tagId": 100,
                "tagName": "后端",
                "userId": 34933,
                "userOutId": "694916097488",
                "username": "生信分析笔记",
                "avatar": "https://files.mdnice.com/pic/999f0227-630d-4ad3-9e0a-f53f7aa52212.jpg",
                "description": "在遗传学中，群体指的是一组具有共同遗传特征的个体，而个体则是指单个生物体。群体中的个体之间可以存在遗传交流和基因流动，这会导致群体中的基因频率发生变化。今天分享的笔记是群体进化与选择分析，包括Pi、F",
                "level": 2,
                "publishTime": "2024/08/19",
                "readingNum": 2,
                "likeNum": 0,
                "introduction": "欢迎关注公众号：生信分析笔记",
                "followWords": "关注领取免费资料",
                "followPic": "https://files.mdnice.com/pic/c5552ee9-95f5-48be-88a2-f0d94b53312e.png",
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "f0e6c76d84134b4b90f01ac4dad384b1",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 141,
                    "createTime": "2024-08-06 19:05"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "158a2e3e2fc64af68585a7350c43980a"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}