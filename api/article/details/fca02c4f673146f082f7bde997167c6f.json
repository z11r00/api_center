{
    "props": {
        "pageProps": {
            "query": {
                "id": "fca02c4f673146f082f7bde997167c6f"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85270,
                "outId": "fca02c4f673146f082f7bde997167c6f",
                "articleOutId": "fca02c4f673146f082f7bde997167c6f",
                "html": "<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">Sklearn数据处理技巧</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">探索 10 个您可能未见过的 Sklearn 功能，它们可以优雅地替代手动执行的常见操作。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">查看Sklearn 的<a href=\"https://scikit-learn.org/stable/modules/classes.html#api-reference\" style=\"text-decoration: none; color: #1e6bb8; word-wrap: break-word; font-weight: bold; border-bottom: 1px solid #1e6bb8;\">API 参考</a> （https://scikit-learn.org/stable/modules/classes.html#api-reference），最常用的模型和函数只是该库所能实现的一小部分。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">我发现许多估算器、转换器和实用函数可以实现数据处理的绝大多数常见操作。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">1. 协方差EllipticEnvelope</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">数据分布中存在异常值是常见的情况。许多算法都能处理异常值，EllipticEnvelope 是 Sklearn 内置的一个优秀示例。该算法在检测正态分布（高斯）特征中的异常值方面表现出色。下面是一个示例，展示了如何使用 EllipticEnvelope 来检测异常值：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">import&nbsp;numpy&nbsp;as&nbsp;np<br>from&nbsp;sklearn.covariance&nbsp;import&nbsp;EllipticEnvelope<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Create&nbsp;a&nbsp;sample&nbsp;normal&nbsp;distribution</span><br>X&nbsp;=&nbsp;np.random.normal(loc=5,&nbsp;scale=2,&nbsp;size=50).reshape(-1,&nbsp;1)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Fit&nbsp;the&nbsp;estimator</span><br>ee&nbsp;=&nbsp;EllipticEnvelope(random_state=0)<br>_&nbsp;=&nbsp;ee.fit(X)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Test</span><br><span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">test</span>&nbsp;=&nbsp;np.array([6,&nbsp;8,&nbsp;20,&nbsp;4,&nbsp;5,&nbsp;6,&nbsp;10,&nbsp;13]).reshape(-1,&nbsp;1)<br>ee.predict(<span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">test</span>)<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">array([&nbsp;1,&nbsp;&nbsp;1,&nbsp;-1,&nbsp;&nbsp;1,&nbsp;&nbsp;1,&nbsp;&nbsp;1,&nbsp;-1,&nbsp;-1])<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">2. 特征选择 RFECV</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">选择最有助于预测的特征是对抗过拟合和降低模型复杂性的必要步骤。Sklearn 提供的递归特征消除 (RFECV) 是其中一个强大的工具。它使用交叉验证自动找到最重要的特征并丢弃其余特征。以下是合成数据集上的示例：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.datasets&nbsp;import&nbsp;make_regression<br>from&nbsp;sklearn.feature_selection&nbsp;import&nbsp;RFECV<br>from&nbsp;sklearn.linear_model&nbsp;import&nbsp;Ridge<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Build&nbsp;a&nbsp;synthetic&nbsp;dataset</span><br>X,&nbsp;y&nbsp;=&nbsp;make_regression(n_samples=10000,&nbsp;n_features=15,&nbsp;n_informative=10)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Init/fit&nbsp;the&nbsp;selector</span><br>rfecv&nbsp;=&nbsp;RFECV(estimator=Ridge(),&nbsp;cv=5)<br>_&nbsp;=&nbsp;rfecv.fit(X,&nbsp;y)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Transform&nbsp;the&nbsp;feature&nbsp;array</span><br>rfecv.transform(X).shape<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">(10000,&nbsp;10)<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">假数据集有 15 个特征，其中 10 个是有用的，其余的是多余的。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">调用向.shape我们展示了成功删除了所有 5 个不必要的特征。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">3. 简单分类器/回归器ExtraTreesRegressor</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">虽然随机森林非常强大，但过拟合风险也很高。Sklearn 提供了一种名为 ExtraTrees 的替代方案，具有更多随机性，可以降低方差但会略微增加偏差。以下是 ExtraTreesRegressor 与其他模型的比较：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.ensemble&nbsp;import&nbsp;ExtraTreesRegressor,&nbsp;RandomForestRegressor<br>from&nbsp;sklearn.model_selection&nbsp;import&nbsp;cross_val_score<br>from&nbsp;sklearn.tree&nbsp;import&nbsp;DecisionTreeRegressor<br><br>X,&nbsp;y&nbsp;=&nbsp;make_regression(n_samples=10000,&nbsp;n_features=20)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Decision&nbsp;trees</span><br>clf&nbsp;=&nbsp;DecisionTreeRegressor(max_depth=None,&nbsp;min_samples_split=2,&nbsp;random_state=0)<br>scores&nbsp;=&nbsp;cross_val_score(clf,&nbsp;X,&nbsp;y,&nbsp;cv=5)<br>scores.mean()<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">0.6908002345849636<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\"><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Random&nbsp;Forest</span><br>clf&nbsp;=&nbsp;RandomForestRegressor(<br>&nbsp;&nbsp;&nbsp;&nbsp;n_estimators=10,&nbsp;max_depth=None,&nbsp;min_samples_split=2,&nbsp;random_state=0<br>)<br>scores&nbsp;=&nbsp;cross_val_score(clf,&nbsp;X,&nbsp;y,&nbsp;cv=5)<br>scores.mean()<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">0.8738017209916411<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\"><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;ExtraTrees</span><br>clf&nbsp;=&nbsp;ExtraTreesRegressor(<br>&nbsp;&nbsp;&nbsp;&nbsp;n_estimators=10,&nbsp;max_depth=None,&nbsp;min_samples_split=2,&nbsp;random_state=0<br>)<br>scores&nbsp;=&nbsp;cross_val_score(clf,&nbsp;X,&nbsp;y,&nbsp;cv=5)<br>scores.mean()<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">0.8914278722893796<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">如您所见，ExtraTreesRegressor 在合成数据集上的表现优于随机森林。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">4. 数据插补impute.IterativeImputer和KNNImputer</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">对于更强大和先进的插补技术，Sklearn 提供了 KNNImputer 和 IterativeImputer。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">KNNImputer 使用 k-Nearest-Neighbors 算法找到缺失值的最佳替代：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.impute&nbsp;import&nbsp;KNNImputer<br>import&nbsp;numpy&nbsp;as&nbsp;np<br><br>X&nbsp;=&nbsp;[[1,&nbsp;2,&nbsp;np.nan],&nbsp;[3,&nbsp;4,&nbsp;3],&nbsp;[np.nan,&nbsp;6,&nbsp;5],&nbsp;[8,&nbsp;8,&nbsp;7]]<br>imputer&nbsp;=&nbsp;KNNImputer(n_neighbors=2)<br><span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">print</span>(imputer.fit_transform(X))<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">array([[1.&nbsp;,&nbsp;2.&nbsp;,&nbsp;4.&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3.&nbsp;,&nbsp;4.&nbsp;,&nbsp;3.&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5.5,&nbsp;6.&nbsp;,&nbsp;5.&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8.&nbsp;,&nbsp;8.&nbsp;,&nbsp;7.&nbsp;]])<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">IterativeImputer 更加稳健，通过将每个具有缺失值的特征建模为其余特征的函数来查找缺失值：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.experimental&nbsp;import&nbsp;enable_iterative_imputer<br>from&nbsp;sklearn.impute&nbsp;import&nbsp;IterativeImputer<br><br>imp&nbsp;=&nbsp;IterativeImputer(max_iter=10,&nbsp;random_state=0)<br><span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">print</span>(imp.fit_transform(X))<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">array([[1.&nbsp;,&nbsp;2.&nbsp;,&nbsp;3.989],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[3.&nbsp;,&nbsp;4.&nbsp;,&nbsp;3.&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[5.5,&nbsp;6.&nbsp;,&nbsp;5.&nbsp;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[8.&nbsp;,&nbsp;8.&nbsp;,&nbsp;7.&nbsp;]])<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">5. 黑盒可视化tree.plot_tree</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">Sklearn 允许你使用 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">plot_tree</code> 函数绘制单个决策树的结构，对于刚开始学习基于树模型的初学者来说非常有用：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.datasets&nbsp;import&nbsp;load_iris<br>from&nbsp;sklearn.tree&nbsp;import&nbsp;DecisionTreeClassifier,&nbsp;plot_tree<br>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br><br>iris&nbsp;=&nbsp;load_iris()<br>X,&nbsp;y&nbsp;=&nbsp;iris.data,&nbsp;iris.target<br>clf&nbsp;=&nbsp;DecisionTreeClassifier()<br>clf&nbsp;=&nbsp;clf.fit(X,&nbsp;y)<br><br>plt.figure(figsize=(15,&nbsp;10),&nbsp;dpi=200)<br>plot_tree(clf,&nbsp;feature_names=iris.feature_names,&nbsp;class_names=iris.target_names)<br>plt.show()<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/b094df9a-b347-4fa4-985d-3b294d6f9da1.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">6. 线性模型感知机Perceptron</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">Perceptron 是一个简单的线性二元分类器，适用于大规模学习：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.datasets&nbsp;import&nbsp;make_classification<br>from&nbsp;sklearn.linear_model&nbsp;import&nbsp;Perceptron<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Create&nbsp;a&nbsp;large&nbsp;dataset</span><br>X,&nbsp;y&nbsp;=&nbsp;make_classification(n_samples=100000,&nbsp;n_features=20,&nbsp;n_classes=2)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Init/Fit/Score</span><br>clf&nbsp;=&nbsp;Perceptron()<br>_&nbsp;=&nbsp;clf.fit(X,&nbsp;y)<br>clf.score(X,&nbsp;y)<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">0.97345<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">特征选择 SelectFromModel</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">Sklearn 提供的 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">SelectFromModel</code> 是另一种基于模型的特征选择估计器，对于大数据集非常有效：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.feature_selection&nbsp;import&nbsp;SelectFromModel<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Make&nbsp;a&nbsp;dataset&nbsp;with&nbsp;40&nbsp;uninformative&nbsp;features</span><br>X,&nbsp;y&nbsp;=&nbsp;make_regression(n_samples=int(1e4),&nbsp;n_features=50,&nbsp;n_informative=10)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Init&nbsp;the&nbsp;selector&nbsp;and&nbsp;transform&nbsp;feature&nbsp;array</span><br>selector&nbsp;=&nbsp;SelectFromModel(estimator=ExtraTreesRegressor()).fit(X,&nbsp;y)<br><br>selector.transform(X).shape<br></code></pre> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">(10000,&nbsp;7)<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">混淆矩阵 ConfusionMatrixDisplay</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">混淆矩阵是分类问题的圣杯，Sklearn 允许您计算和绘制混淆矩阵：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.metrics&nbsp;import&nbsp;ConfusionMatrixDisplay<br>from&nbsp;sklearn.model_selection&nbsp;import&nbsp;train_test_split<br>import&nbsp;sklearn<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Make&nbsp;a&nbsp;binary&nbsp;classification&nbsp;problem</span><br>X,&nbsp;y&nbsp;=&nbsp;make_classification(n_samples=200,&nbsp;n_features=5,&nbsp;n_classes=2)<br>X_train,&nbsp;X_test,&nbsp;y_train,&nbsp;y_test&nbsp;=&nbsp;train_test_split(<br>&nbsp;&nbsp;&nbsp;&nbsp;X,&nbsp;y,&nbsp;test_size=0.5,&nbsp;random_state=1121218<br>)<br><br>clf&nbsp;=&nbsp;sklearn.tree.ExtraTreeClassifier().fit(X_train,&nbsp;y_train)<br><br>fig,&nbsp;ax&nbsp;=&nbsp;plt.subplots(figsize=(5,&nbsp;4),&nbsp;dpi=100)<br>ConfusionMatrixDisplay.from_estimator(clf,&nbsp;X_test,&nbsp;y_test,&nbsp;ax=ax);<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/ad906dbc-85a3-48b6-b421-41167fb1f8ea.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">9. 数据预处理 PowerTransformer</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">对于高偏态数据，Sklearn 实现了 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">PowerTransformer</code>，使用对数变换将倾斜特征转换为正态分布：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">import&nbsp;seaborn&nbsp;as&nbsp;sns<br>import&nbsp;pandas&nbsp;as&nbsp;pd<br>diamonds&nbsp;=&nbsp;pd.read_csv(<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"../data/diamonds.csv\"</span>)<br>diamonds[[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"price\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"carat\"</span>]].hist(figsize=(10,&nbsp;5));<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/65378553-a8e5-4aa3-9596-34f3b250aafc.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">两者都严重倾斜。让我们使用对数变换来解决这个问题：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.preprocessing&nbsp;import&nbsp;PowerTransformer<br><br>pt&nbsp;=&nbsp;PowerTransformer()<br>diamonds.loc[:,&nbsp;[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"price\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"carat\"</span>]]&nbsp;=&nbsp;pt.fit_transform(diamonds[[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"price\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"carat\"</span>]])<br><br>diamonds[[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"price\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"carat\"</span>]].hist(figsize=(10,&nbsp;5));<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/47e6b116-90cf-4b0f-b5e7-7e8321cf4031.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">10. 模型组合make_pipeline</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">在 Sklearn 中，有一种使用<code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">make_pipeline</code>函数创建 Pipeline 实例的简写方法。该函数无需命名每个步骤，也无需让代码变得冗长，只需接受转换器和估算器并完成其工作：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px;\"><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; background: #f8f8f8; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; border-radius: 0px; font-size: 12px; -webkit-overflow-scrolling: touch;\">from&nbsp;sklearn.impute&nbsp;import&nbsp;SimpleImputer<br>from&nbsp;sklearn.pipeline&nbsp;import&nbsp;make_pipeline<br>from&nbsp;sklearn.preprocessing&nbsp;import&nbsp;StandardScaler<br>from&nbsp;sklearn.ensemble&nbsp;import&nbsp;ExtraTreesRegressor,&nbsp;RandomForestRegressor<br><br>pipeline&nbsp;=&nbsp;make_pipeline(SimpleImputer(),&nbsp;StandardScaler(),&nbsp;ExtraTreesRegressor())<br><br>pipeline<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/9cd1eb2b-270e-4bbc-b02b-4b2b693f8eb3.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">通过掌握这些 Sklearn 工具，您可以大大提高数据处理和模型训练的效率。希望这些技巧对您有所帮助！</p>",
                "title": "10个机器学习数据处理Sklearn技巧，建议收藏！",
                "categoryId": 3,
                "categoryName": "人工智能",
                "tagId": 116,
                "tagName": "机器学习",
                "userId": 40204,
                "userOutId": "706880289656",
                "username": "LonghaoWang",
                "avatar": "https://files.mdnice.com/pic/20a54d83-6259-4b66-8689-c8ce6b9e8616.jpg",
                "description": "Sklearn数据处理技巧探索10个您可能未见过的Sklearn功能，它们可以优雅地替代手动执行的常见操作。查看Sklearn的API参考（https://scikit-learn.org/stabl",
                "level": 2,
                "publishTime": "2024/10/18",
                "readingNum": 2,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "ffe00cb8fcef4def81f23ac36ce58752",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 54,
                    "createTime": "2024-08-06 19:05"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "fca02c4f673146f082f7bde997167c6f"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}