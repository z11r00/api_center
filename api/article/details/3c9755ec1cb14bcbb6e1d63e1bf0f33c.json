{
    "props": {
        "pageProps": {
            "query": {
                "id": "3c9755ec1cb14bcbb6e1d63e1bf0f33c"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85309,
                "outId": "3c9755ec1cb14bcbb6e1d63e1bf0f33c",
                "articleOutId": "3c9755ec1cb14bcbb6e1d63e1bf0f33c",
                "html": "<h1 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 24px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\">决策树和随机森林的可视化</span><span class=\"suffix\"></span></h1> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">机器学习在数据建模中展示了强大的性能，然而这种模型往往缺少可解释性。可视化机器学习模型，特别是决策树和随机森林，可以大大增强我们对模型决策过程的理解。通过可视化，我们能够看到数据在模型中的决策路径，这不仅有助于解释模型的行为，还能帮助我们识别和修正模型中的潜在问题。此外，可视化还可以提高与非技术人员沟通的效率，使他们更直观地理解模型的工作原理。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">如果我们可以将这些决策路径可视化，那么创建详细的路径图表将会帮助我们理解模型背后的决策依据。这对于模型的解释性、透明性和调试都是至关重要的。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">决策树可视化</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">首先，我们需要安装以下两个包：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">pip&nbsp;install&nbsp;pybaobabdt<br>pip&nbsp;install&nbsp;pygraphviz<br></code></pre> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">接下来，我们以Python的鸢尾花数据为例，展示如何使用这些工具进行决策树的可视化：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">import&nbsp;pybaobabdt<br>import&nbsp;pandas&nbsp;as&nbsp;pd<br>from&nbsp;scipy.io&nbsp;import&nbsp;arff<br>from&nbsp;sklearn.tree&nbsp;import&nbsp;DecisionTreeClassifier&nbsp;<br><br>data&nbsp;=&nbsp;pd.read_csv(<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'/home/mw/project/iris.csv'</span>)<br>data<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/a547b3e9-0184-4a15-bc22-72dbe8354c05.png\" alt=\"image-20240628162324463\" style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n <figcaption style=\"margin-top: 5px; text-align: center; color: #888; font-size: 14px;\">\n   image-20240628162324463 \n </figcaption> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">我们使用 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">Sepal.Length</code>、<code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">Sepal.Width</code>、<code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">Petal.Length</code> 和 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">Petal.Width</code> 四个属性来预测 <code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; color: #1e6bb8; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all;\">Species</code>（物种）。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">接下来，创建决策树模型并可视化路径：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">df&nbsp;=&nbsp;data<br>y&nbsp;=&nbsp;list(df[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Species'</span>])<br>X&nbsp;=&nbsp;df.drop(columns=[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Species'</span>])<br>features&nbsp;=&nbsp;list(X.columns)<br>clf&nbsp;=&nbsp;DecisionTreeClassifier().fit(X,&nbsp;y)<br>ax&nbsp;=&nbsp;pybaobabdt.drawTree(clf,&nbsp;size=10,&nbsp;dpi=300,&nbsp;features=features)&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#Visualize&nbsp;the&nbsp;tree</span><br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/238cb414-66a0-45f4-9803-8eabf7436739.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">如图所示，我们可以清楚地了解每个决策的路径和阈值。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">通过使用颜色图，我们还可以突出显示特定的类别：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">from&nbsp;matplotlib.colors&nbsp;import&nbsp;ListedColormap<br><br><br>ax&nbsp;=&nbsp;pybaobabdt.drawTree(<br>&nbsp;&nbsp;&nbsp;&nbsp;clf,<br>&nbsp;&nbsp;&nbsp;&nbsp;size=10,<br>&nbsp;&nbsp;&nbsp;&nbsp;dpi=600,<br>&nbsp;&nbsp;&nbsp;&nbsp;maxdepth=6,<br>&nbsp;&nbsp;&nbsp;&nbsp;colormap=ListedColormap([<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"#01a2d9\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"gray\"</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"#d5695d\"</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"gray\"</span>]),&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Highlight&nbsp;Class&nbsp;3&nbsp;and&nbsp;5</span><br>&nbsp;&nbsp;&nbsp;&nbsp;features=features)<br><br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/535ddbe4-aa9d-4b44-9c61-96cc21325d0a.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">随机森林可视化</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">随机森林的可视化与决策树的可视化非常相似。我们可以用一个循环来绘制每一棵树：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">import&nbsp;pybaobabdt<br>import&nbsp;pandas&nbsp;as&nbsp;pd<br>from&nbsp;scipy.io&nbsp;import&nbsp;arff<br>import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br>from&nbsp;sklearn.ensemble&nbsp;import&nbsp;RandomForestClassifier<br><br>y&nbsp;=&nbsp;list(df[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Species'</span>])<br><br>X&nbsp;=&nbsp;df.drop(columns=[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Species'</span>])<br>features&nbsp;=&nbsp;list(X.columns)<br><br>clf&nbsp;=&nbsp;RandomForestClassifier(n_estimators=20,&nbsp;n_jobs=-1,&nbsp;random_state=0)<br>clf.fit(X,&nbsp;y)<br><br>size&nbsp;=&nbsp;(15,&nbsp;15)<br>plt.rcParams[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'figure.figsize'</span>]&nbsp;=&nbsp;size<br>fig&nbsp;=&nbsp;plt.figure(figsize=size,&nbsp;dpi=300)<br><br><br><span class=\"hljs-keyword\" style=\"color: #333; font-weight: bold; line-height: 26px;\">for</span>&nbsp;idx,&nbsp;tree&nbsp;<span class=\"hljs-keyword\" style=\"color: #333; font-weight: bold; line-height: 26px;\">in</span>&nbsp;enumerate(clf.estimators_):<br>&nbsp;&nbsp;&nbsp;&nbsp;ax1&nbsp;=&nbsp;fig.add_subplot(5,&nbsp;4,&nbsp;idx&nbsp;+&nbsp;1)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;pybaobabdt.drawTree(tree,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model=clf,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;size=15,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpi=300,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxdepth=8,&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Set&nbsp;the&nbsp;depth&nbsp;for&nbsp;each&nbsp;tree</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;features=features,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ax=ax1)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/3d57fb0c-22c1-45d4-a09a-309c0a132110.png\" alt=\"tree\" style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n <figcaption style=\"margin-top: 5px; text-align: center; color: #888; font-size: 14px;\">\n   tree \n </figcaption> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">通过这种方法，我们可以直观地看到每棵树的决策过程，从而更好地理解随机森林的整体行为。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">通过以上步骤，我们可以有效地可视化决策树和随机森林模型，帮助我们更好地理解和解释模型的决策过程。这对于模型的开发、调试和与非技术人员的沟通都是非常有价值的。</p>",
                "title": "把黑箱机器学习模型解释清楚了！可视化随机森林和决策树",
                "categoryId": 3,
                "categoryName": "人工智能",
                "tagId": 115,
                "tagName": "人工智能",
                "userId": 40204,
                "userOutId": "706880289656",
                "username": "LonghaoWang",
                "avatar": "https://files.mdnice.com/pic/20a54d83-6259-4b66-8689-c8ce6b9e8616.jpg",
                "description": "决策树和随机森林的可视化机器学习在数据建模中展示了强大的性能，然而这种模型往往缺少可解释性。可视化机器学习模型，特别是决策树和随机森林，可以大大增强我们对模型决策过程的理解。通过可视化，我们能够看到数",
                "level": 2,
                "publishTime": "2024/10/19",
                "readingNum": 5,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "ffe00cb8fcef4def81f23ac36ce58752",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 63,
                    "createTime": "2024-08-06 19:05"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "3c9755ec1cb14bcbb6e1d63e1bf0f33c"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}