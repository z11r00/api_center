{
    "props": {
        "pageProps": {
            "query": {
                "id": "73cce26729cf40b4b34f7385f7ef9b63"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85599,
                "outId": "73cce26729cf40b4b34f7385f7ef9b63",
                "articleOutId": "73cce26729cf40b4b34f7385f7ef9b63",
                "html": "<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">先上实际效果</p> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/55218/706b94e8-1024-4977-96c0-fe05a78c3cb5.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/55218/779d8e49-bc42-457e-81a3-f967a8c21a43.png\" alt style=\"display: block; margin-top: 0px; margin-right: auto; margin-bottom: 0px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">看着上面的效果，你会想到什么？</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">1、涨停数变少，说明投机情绪在逐渐退潮</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">2、概念涨停变化，比如 风电、军工、光伏 涨停数多起来了，说明了资金开始切换到了相对低位。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">3、越早涨停的，说明资金越认可。尽量观察 越早涨停的股，相对更强势。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">程序我准备用streamlit构建应用界面， tushare获取交易日历数据， wencai获取涨停数分析。</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">另外程序运行时间可能要考虑的点：</p> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(0, 0, 0); font-size: 16px; line-height: 1.8em; letter-spacing: 0em; text-align: left; text-indent: 0em; margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px;\">比如今天是交易日，那么9点30之前执行， 基本是考虑10月22日、10月23日的涨停对比吧。 交易时间段执行 判断当天什么时候题材概念比较火热。</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\">import&nbsp;streamlit&nbsp;as&nbsp;st<br>import&nbsp;pywencai<br>import&nbsp;pandas&nbsp;as&nbsp;pd<br>from&nbsp;datetime&nbsp;import&nbsp;datetime,&nbsp;timedelta<br>import&nbsp;tushare&nbsp;as&nbsp;ts<br>import&nbsp;plotly.graph_objects&nbsp;as&nbsp;go<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Setting&nbsp;up&nbsp;pandas&nbsp;display&nbsp;options</span><br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.unicode.ambiguous_as_wide'</span>,&nbsp;True)<br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.unicode.east_asian_width'</span>,&nbsp;True)<br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.max_rows'</span>,&nbsp;None)<br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.max_columns'</span>,&nbsp;None)<br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.expand_frame_repr'</span>,&nbsp;False)<br>pd.set_option(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'display.max_colwidth'</span>,&nbsp;100)<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Initialize&nbsp;Tushare&nbsp;with&nbsp;your&nbsp;token</span><br>ts.set_token(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'YOUR_TUSHARE_TOKEN'</span>)<br>pro&nbsp;=&nbsp;ts.pro_api()<br><br>def&nbsp;get_latest_trading_day():<br>&nbsp;&nbsp;&nbsp;&nbsp;now&nbsp;=&nbsp;datetime.now()<br>&nbsp;&nbsp;&nbsp;&nbsp;today&nbsp;=&nbsp;now.date()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Get&nbsp;the&nbsp;trading&nbsp;calendar&nbsp;for&nbsp;the&nbsp;past&nbsp;week</span><br>&nbsp;&nbsp;&nbsp;&nbsp;cal_df&nbsp;=&nbsp;pro.trade_cal(exchange=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">''</span>,&nbsp;start_date=(today&nbsp;-&nbsp;timedelta(days=10)).strftime(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%Y%m%d'</span>),&nbsp;end_date=today.strftime(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%Y%m%d'</span>))<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Filter&nbsp;for&nbsp;open&nbsp;trading&nbsp;days&nbsp;and&nbsp;sort&nbsp;in&nbsp;descending&nbsp;order</span><br>&nbsp;&nbsp;&nbsp;&nbsp;open_days&nbsp;=&nbsp;cal_df[cal_df[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'is_open'</span>]&nbsp;==&nbsp;1][<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'cal_date'</span>].sort_values(ascending=False)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Check&nbsp;if&nbsp;today&nbsp;is&nbsp;a&nbsp;trading&nbsp;day</span><br>&nbsp;&nbsp;&nbsp;&nbsp;is_trading_day&nbsp;=&nbsp;cal_df[cal_df[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'cal_date'</span>]&nbsp;==&nbsp;today.strftime(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%Y%m%d'</span>)][<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'is_open'</span>].iloc[0]&nbsp;==&nbsp;1<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;is_trading_day:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;If&nbsp;it's&nbsp;before&nbsp;9：30&nbsp;AM&nbsp;on&nbsp;a&nbsp;trading&nbsp;day,&nbsp;use&nbsp;the&nbsp;previous&nbsp;trading&nbsp;day</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;now.time()&nbsp;&lt;&nbsp;datetime.strptime(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'09:30'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%H:%M'</span>).time():<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;open_days.iloc[1]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">else</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;open_days.iloc[0]<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">else</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;If&nbsp;today&nbsp;is&nbsp;not&nbsp;a&nbsp;trading&nbsp;day,&nbsp;use&nbsp;the&nbsp;most&nbsp;recent&nbsp;trading&nbsp;day</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;open_days.iloc[0]<br><br>def&nbsp;get_previous_trading_day(date):<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Get&nbsp;the&nbsp;trading&nbsp;calendar&nbsp;for&nbsp;the&nbsp;past&nbsp;week&nbsp;before&nbsp;the&nbsp;given&nbsp;date</span><br>&nbsp;&nbsp;&nbsp;&nbsp;end_date&nbsp;=&nbsp;datetime.strptime(date,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%Y%m%d'</span>).date()<br>&nbsp;&nbsp;&nbsp;&nbsp;start_date&nbsp;=&nbsp;end_date&nbsp;-&nbsp;timedelta(days=10)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;cal_df&nbsp;=&nbsp;pro.trade_cal(exchange=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">''</span>,&nbsp;start_date=start_date.strftime(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'%Y%m%d'</span>),&nbsp;end_date=date)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Filter&nbsp;for&nbsp;open&nbsp;trading&nbsp;days&nbsp;and&nbsp;sort&nbsp;in&nbsp;descending&nbsp;order</span><br>&nbsp;&nbsp;&nbsp;&nbsp;open_days&nbsp;=&nbsp;cal_df[cal_df[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'is_open'</span>]&nbsp;==&nbsp;1][<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'cal_date'</span>].sort_values(ascending=False)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Return&nbsp;the&nbsp;previous&nbsp;trading&nbsp;day</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;open_days.iloc[1]&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;iloc[1]&nbsp;because&nbsp;iloc[0]&nbsp;would&nbsp;be&nbsp;the&nbsp;input&nbsp;date&nbsp;itself</span><br><br>def&nbsp;get_limit_up_data(date):<br>&nbsp;&nbsp;&nbsp;&nbsp;param&nbsp;=&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"{date}涨停，非涉嫌信息披露违规且非立案调查且非ST，非科创板，非北交所\"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;df&nbsp;=&nbsp;pywencai.get(query=param,&nbsp;sort_key=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'成交金额'</span>,&nbsp;sort_order=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'desc'</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;selected_columns&nbsp;=&nbsp;[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'股票代码'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'股票简称'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'最新价'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'最新涨跌幅'</span>,&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'首次涨停时间[{date}]'</span>,&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'连续涨停天数[{date}]'</span>,&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'涨停原因类别[{date}]'</span>,&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'a股市值(不含限售股)[{date}]'</span>,&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'涨停类型[{date}]'</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;df[selected_columns]<br><br>def&nbsp;get_concept_counts(df,&nbsp;date):<br>&nbsp;&nbsp;&nbsp;&nbsp;concepts&nbsp;=&nbsp;df[f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'涨停原因类别[{date}]'</span>].str.split(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'+'</span>).explode().reset_index(drop=True)<br>&nbsp;&nbsp;&nbsp;&nbsp;concept_counts&nbsp;=&nbsp;concepts.value_counts().reset_index()<br>&nbsp;&nbsp;&nbsp;&nbsp;concept_counts.columns&nbsp;=&nbsp;[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'概念'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数'</span>]<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-built_in\" style=\"color: #e6c07b; line-height: 26px;\">return</span>&nbsp;concept_counts<br><br>def&nbsp;main():<br>&nbsp;&nbsp;&nbsp;&nbsp;st.title(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"A股涨停概念分析\"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;today&nbsp;=&nbsp;get_latest_trading_day()<br>&nbsp;&nbsp;&nbsp;&nbsp;yesterday&nbsp;=&nbsp;get_previous_trading_day(today)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;st.write(f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"分析日期:&nbsp;{today}&nbsp;(最新交易日)&nbsp;和&nbsp;{yesterday}&nbsp;(前一交易日)\"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Fetch&nbsp;data&nbsp;for&nbsp;both&nbsp;days</span><br>&nbsp;&nbsp;&nbsp;&nbsp;today_df&nbsp;=&nbsp;get_limit_up_data(today)<br>&nbsp;&nbsp;&nbsp;&nbsp;yesterday_df&nbsp;=&nbsp;get_limit_up_data(yesterday)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Get&nbsp;concept&nbsp;counts&nbsp;for&nbsp;both&nbsp;days</span><br>&nbsp;&nbsp;&nbsp;&nbsp;today_concepts&nbsp;=&nbsp;get_concept_counts(today_df,&nbsp;today)<br>&nbsp;&nbsp;&nbsp;&nbsp;yesterday_concepts&nbsp;=&nbsp;get_concept_counts(yesterday_df,&nbsp;yesterday)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Merge&nbsp;concept&nbsp;counts</span><br>&nbsp;&nbsp;&nbsp;&nbsp;merged_concepts&nbsp;=&nbsp;pd.merge(today_concepts,&nbsp;yesterday_concepts,&nbsp;on=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'概念'</span>,&nbsp;how=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'outer'</span>,&nbsp;suffixes=(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'_today'</span>,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'_yesterday'</span>))<br>&nbsp;&nbsp;&nbsp;&nbsp;merged_concepts&nbsp;=&nbsp;merged_concepts.fillna(0)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Calculate&nbsp;change</span><br>&nbsp;&nbsp;&nbsp;&nbsp;merged_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'变化'</span>]&nbsp;=&nbsp;merged_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数_today'</span>]&nbsp;-&nbsp;merged_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数_yesterday'</span>]<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Sort&nbsp;by&nbsp;'出现次数_today'&nbsp;in&nbsp;descending&nbsp;order</span><br>&nbsp;&nbsp;&nbsp;&nbsp;sorted_concepts&nbsp;=&nbsp;merged_concepts.sort_values(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数_today'</span>,&nbsp;ascending=False)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Display&nbsp;total&nbsp;limit-up&nbsp;stocks&nbsp;for&nbsp;both&nbsp;days</span><br>&nbsp;&nbsp;&nbsp;&nbsp;st.subheader(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"涨停股票数量变化\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;today_total&nbsp;=&nbsp;len(today_df)<br>&nbsp;&nbsp;&nbsp;&nbsp;yesterday_total&nbsp;=&nbsp;len(yesterday_df)<br>&nbsp;&nbsp;&nbsp;&nbsp;change&nbsp;=&nbsp;today_total&nbsp;-&nbsp;yesterday_total<br><br>&nbsp;&nbsp;&nbsp;&nbsp;col1,&nbsp;col2,&nbsp;col3&nbsp;=&nbsp;st.columns(3)<br>&nbsp;&nbsp;&nbsp;&nbsp;col1.metric(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"昨日涨停数\"</span>,&nbsp;yesterday_total)<br>&nbsp;&nbsp;&nbsp;&nbsp;col2.metric(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"今日涨停数\"</span>,&nbsp;today_total)<br>&nbsp;&nbsp;&nbsp;&nbsp;col3.metric(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"变化\"</span>,&nbsp;change,&nbsp;f<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"{change:+d}\"</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Display&nbsp;concept&nbsp;changes</span><br>&nbsp;&nbsp;&nbsp;&nbsp;st.subheader(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"涨停概念变化\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;st.dataframe(sorted_concepts)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Create&nbsp;a&nbsp;bar&nbsp;chart&nbsp;for&nbsp;top&nbsp;10&nbsp;concepts</span><br>&nbsp;&nbsp;&nbsp;&nbsp;top_10_concepts&nbsp;=&nbsp;sorted_concepts.head(10)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;fig&nbsp;=&nbsp;go.Figure(data=[<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go.Bar(name=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'今日'</span>,&nbsp;x=top_10_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'概念'</span>],&nbsp;y=top_10_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数_today'</span>]),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;go.Bar(name=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'昨日'</span>,&nbsp;x=top_10_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'概念'</span>],&nbsp;y=top_10_concepts[<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'出现次数_yesterday'</span>])<br>&nbsp;&nbsp;&nbsp;&nbsp;])<br><br>&nbsp;&nbsp;&nbsp;&nbsp;fig.update_layout(barmode=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'group'</span>,&nbsp;title=<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'Top&nbsp;10&nbsp;涨停概念对比'</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;st.plotly_chart(fig)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;Display&nbsp;raw&nbsp;data</span><br>&nbsp;&nbsp;&nbsp;&nbsp;st.subheader(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"今日涨停股票详情\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;st.dataframe(today_df)<br><br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;__name__&nbsp;==&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"__main__\"</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;main()<br><br><br></code></pre>",
                "title": "【Python技术】借助tushare、wencai完成前一交易日与最近交易日涨停变化分析",
                "categoryId": 1,
                "categoryName": "后端",
                "tagId": 103,
                "tagName": "Python",
                "userId": 55218,
                "userOutId": "179427763817",
                "username": "子晓聊技术",
                "avatar": "https://files.mdnice.com/user/55218/user-avatar/5fc0cb71-d7f6-40e1-aec2-23fee5805e47.jpg",
                "description": "先上实际效果看着上面的效果，你会想到什么？1、涨停数变少，说明投机情绪在逐渐退潮2、概念涨停变化，比如风电、军工、光伏涨停数多起来了，说明了资金开始切换到了相对低位。3、越早涨停的，说明资金越认可。尽",
                "level": 1,
                "publishTime": "2024/10/25",
                "readingNum": 7,
                "likeNum": 0,
                "introduction": "程序员，分享AI、JAVA、Python",
                "followWords": "扫码添加好友",
                "followPic": "https://files.mdnice.com/user/55218/follow/4a2b995c-733f-473b-8738-4b1a7c8432bf.jpg",
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "7617af3560d946f1b0782e88278ac9b6",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 4,
                    "createTime": "2024-08-06 19:03"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "73cce26729cf40b4b34f7385f7ef9b63"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}