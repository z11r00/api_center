{
    "props": {
        "pageProps": {
            "query": {
                "id": "4ee5ad71054942c2a38487f0283a224a"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85310,
                "outId": "4ee5ad71054942c2a38487f0283a224a",
                "articleOutId": "4ee5ad71054942c2a38487f0283a224a",
                "html": "<h1 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 24px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\">可解释机器学习在社会经济模型的应用</span><span class=\"suffix\"></span></h1> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">在地学中尤其是人文地理学，有时我们要创建社会经济模型。机器学习作为一种强大的工具，能够在这些模型中达到高精度的预测效果。然而，在许多实际应用中，可解释性是关键，因为它不仅帮助我们理解模型的决策过程，还能增加用户对模型预测结果的信任。本文将探讨如何在社会经济模型中应用可解释机器学习，特别是使用澳洲公开数据集进行分析。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">数据</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">本文使用澳洲公开的数据集</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">import&nbsp;pandas&nbsp;as&nbsp;pd<br>from&nbsp;sklearn.model_selection&nbsp;import&nbsp;train_test_split<br>from&nbsp;sklearn.ensemble&nbsp;import&nbsp;RandomForestRegressor<br>from&nbsp;sklearn.metrics&nbsp;import&nbsp;mean_squared_error,&nbsp;r2_score<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Load&nbsp;the&nbsp;dataset</span><br>file_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'/home/mw/input/eco2933/data.csv'</span><br>data&nbsp;=&nbsp;pd.read_csv(file_path)<br>data&nbsp;=&nbsp;data.dropna()<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/a94fe002-d270-4e31-88eb-69b5a8db6641.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">包括人口、经济、教育、地理信息等多种变量。我们的目标是预测各个地区的劣势人口数量（Disadvantage）。劣势人口数量往往意味着低收入和较差的生活条件，如果能够准确模拟这种情况，将对区域发展和政策制定提供重要的指导。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">我们将数据集划分为7：3，分别用来训练和测试</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\"><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Exclude&nbsp;the&nbsp;date&nbsp;column&nbsp;and&nbsp;separate&nbsp;the&nbsp;target&nbsp;variable</span><br>X&nbsp;=&nbsp;data.drop(columns=[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Disadvantage'</span>])<br>y&nbsp;=&nbsp;data[<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Disadvantage'</span>]<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Split&nbsp;the&nbsp;data&nbsp;into&nbsp;training&nbsp;and&nbsp;testing&nbsp;sets</span><br>X_train,&nbsp;X_test,&nbsp;y_train,&nbsp;y_test&nbsp;=&nbsp;train_test_split(X,&nbsp;y,&nbsp;test_size=0.3,&nbsp;random_state=101)<br></code></pre> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">模型</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">这里我们构建一个随机森林模型：</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">随机森林模型因其在处理复杂数据集时的高效性和准确性而被广泛应用。以下是模型的训练和评估代码：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\"><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Initialize&nbsp;and&nbsp;train&nbsp;the&nbsp;RandomForestRegressor</span><br>model&nbsp;=&nbsp;RandomForestRegressor(max_depth=5,&nbsp;random_state=101)<br>model.fit(X_train,&nbsp;y_train)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Predict&nbsp;on&nbsp;the&nbsp;test&nbsp;set</span><br>y_pred&nbsp;=&nbsp;model.predict(X_test)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Evaluate&nbsp;the&nbsp;model</span><br>mse&nbsp;=&nbsp;mean_squared_error(y_test,&nbsp;y_pred)<br>r2&nbsp;=&nbsp;r2_score(y_test,&nbsp;y_pred)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Print&nbsp;the&nbsp;evaluation&nbsp;metrics</span><br><span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">print</span>(f<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'Mean&nbsp;Squared&nbsp;Error:&nbsp;{mse}'</span>)<br><span class=\"hljs-built_in\" style=\"color: #0086b3; line-height: 26px;\">print</span>(f<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'R^2&nbsp;Score:&nbsp;{r2}'</span>)<br></code></pre> \n<ul data-tool=\"mdnice编辑器\" style=\"margin-top: 8px; margin-bottom: 8px; padding-left: 25px; color: black; list-style-type: disc;\"> \n <li> \n  <section style=\"margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;\"> \n   <p style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">Mean Squared Error: 1161.0806348966228</p> \n  </section></li> \n <li> \n  <section style=\"margin-top: 5px; margin-bottom: 5px; line-height: 26px; text-align: left; color: rgb(1,1,1); font-weight: 500;\"> \n   <p style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">R^2 Score: 0.7781199666990248</p> \n  </section></li> \n</ul> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">模型的评估结果显示，均方误差（MSE）为1161.08，R^2得分为0.778，表明模型能够解释78%的变量。这是一个相当高的解释度，表明模型在预测劣势人口数量方面具有良好的性能。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">结果分析</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">接下来，我们在测试集上评估模型的性能，通过绘制观测值与预测值的散点图来直观地展示模型的预测效果：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">import&nbsp;matplotlib.pyplot&nbsp;as&nbsp;plt<br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Predict&nbsp;on&nbsp;the&nbsp;test&nbsp;set</span><br>y_pred&nbsp;=&nbsp;model.predict(X_test)<br><br><span class=\"hljs-comment\" style=\"color: #998; font-style: italic; line-height: 26px;\">#&nbsp;Plot&nbsp;the&nbsp;observed&nbsp;vs&nbsp;predicted&nbsp;values</span><br>plt.figure(figsize=(4,&nbsp;4))<br>plt.scatter(y_test,&nbsp;y_pred,&nbsp;alpha=0.7)<br>plt.title(<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"predict&nbsp;disadvantaged&nbsp;using&nbsp;Machine&nbsp;Learning\"</span>)<br>plt.xlabel(<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"Observed&nbsp;Disadvantaged\"</span>)<br>plt.ylabel(<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">\"Predicted&nbsp;Disadvantage\"</span>)<br>plt.plot([y_test.min(),&nbsp;y_test.max()],&nbsp;[y_test.min(),&nbsp;y_test.max()],&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'--r'</span>,&nbsp;lw=2)<br>plt.text(600,&nbsp;1150,&nbsp;<span class=\"hljs-string\" style=\"color: #d14; line-height: 26px;\">'R^2=0.78'</span>)<br><br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/768d020d-84cf-4d75-9562-befcc49486bd.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">结果显示，模型的预测值与实际观测值之间的相关性较高，表明模型具有较好的稳健性。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">可解释机器学习</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">为了提高模型的可解释性，我们使用SHAP（SHapley Additive exPlanations）值对模型进行解释。SHAP值能够提供每个特征对预测结果的贡献，帮助我们理解模型的决策过程。以下是使用SHAP进行模型解释的代码：</p> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">import&nbsp;shap<br>explainer&nbsp;=&nbsp;shap.Explainer(model)<br>shap_values&nbsp;=&nbsp;explainer.shap_values(X_test)<br>plotsp&nbsp;=&nbsp;shap.summary_plot(shap_values,&nbsp;X_test,&nbsp;max_display=6,&nbsp;&nbsp;show&nbsp;=&nbsp;False)<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/0fb9dd22-f835-484d-b7b6-5fec49567a49.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;\"><span style=\"display: block; background: url(https://files.mdnice.com/point.png); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #f8f8f8; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #333; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #f8f8f8; border-radius: 5px;\">shap.plots.bar(explainer(X_test),&nbsp;max_display=10)<br></code></pre> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/user/40204/e762633b-ddf7-4a14-b5af-dd62992591e4.png\" alt style=\"display: block; margin: 0 auto; max-width: 100%; border-radius: 10px; border: 3px solid #F7D3CC;\"> \n</figure> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">结果表明教育因素排名第一，而经济因素贡献第二，表明一个区域的劣势人口总体上受该地区的教育水平影响。</p> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">通过SHAP值的分析，我们发现教育因素在预测劣势人口数量中起到最重要的作用，其次是经济因素。这表明一个地区的教育水平对劣势人口的数量有着显著影响，而经济因素的影响也不可忽视。</p> \n<h2 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 22px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"background-color: #F7D3CC; color: #FFF; padding: 5px 15px; border-radius: 1px;\">结论</span><span class=\"suffix\"></span></h2> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; margin: 0; line-height: 26px; color: black; font-size: 17px; word-spacing: 3px; letter-spacing: 1px;\">本文通过随机森林模型和SHAP值分析展示了可解释机器学习在社会经济模型中的应用。通过对澳洲公开数据集的分析，我们能够准确预测各个地区的劣势人口数量，并通过可解释性方法揭示了不同特征对预测结果的贡献。这不仅增强了模型的透明性，也为区域发展和政策制定提供了重要的依据。未来的研究可以进一步优化模型，加入更多的变量，以提高预测精度和解释深度。</p>",
                "title": "可解释机器学习创建一个经济社会模型",
                "categoryId": 3,
                "categoryName": "人工智能",
                "tagId": 116,
                "tagName": "机器学习",
                "userId": 40204,
                "userOutId": "706880289656",
                "username": "LonghaoWang",
                "avatar": "https://files.mdnice.com/pic/20a54d83-6259-4b66-8689-c8ce6b9e8616.jpg",
                "description": "可解释机器学习在社会经济模型的应用在地学中尤其是人文地理学，有时我们要创建社会经济模型。机器学习作为一种强大的工具，能够在这些模型中达到高精度的预测效果。然而，在许多实际应用中，可解释性是关键，因为它",
                "level": 2,
                "publishTime": "2024/10/19",
                "readingNum": 3,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "ffe00cb8fcef4def81f23ac36ce58752",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 63,
                    "createTime": "2024-08-06 19:05"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "4ee5ad71054942c2a38487f0283a224a"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}