{
    "props": {
        "pageProps": {
            "query": {
                "id": "60d3cf81fc5f4092a98559755c386f73"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85680,
                "outId": "60d3cf81fc5f4092a98559755c386f73",
                "articleOutId": "60d3cf81fc5f4092a98559755c386f73",
                "html": "<hr data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; height: 0px; padding: 0; border: none; border-top: 1.2px dashed #F4A460;\"> \n<figure data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/pic/935a640f-6d5b-4fe5-8b2f-9a30b16251d3.png\" alt style=\"max-width: 100%; border-radius: 6px; display: block; margin: 20px auto; object-fit: contain;\"> \n</figure> \n<hr data-tool=\"mdnice编辑器\" style=\"margin: 0; margin-top: 10px; margin-bottom: 10px; height: 0px; padding: 0; border: none; border-top: 1.2px dashed #F4A460;\"> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px; text-align: left; margin: 20px 10px 0px 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 4px solid #F79220; color: #595959; text-indent: 0em;\">需求场景：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: #595959; margin: 10px 0px; letter-spacing: 2px; font-size: 14px; word-spacing: 2px; text-indent: 2em; margin: 1px 1px 0px 0px;\">从财务系统中导出了上千份关于不同科目的明细账PDF文件，现在需要将其合并为一个PDF文件备查，接着再按照页码平均拆分为12个PDF文件，并为每一个PDF文件添加页码。</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px; text-align: left; margin: 20px 10px 0px 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 4px solid #F79220; color: #595959; text-indent: 0em;\">模块安装：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fafafa; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #383a42; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fafafa; border-radius: 5px;\">!&nbsp;pip&nbsp;install&nbsp;PyPDF2&nbsp;reportlab&nbsp;io<br></code></pre> \n<h3 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; font-weight: bold; color: black; font-size: 20px; text-align: left; margin: 20px 10px 0px 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; font-weight: bold; display: inline-block; padding-left: 10px; border-left: 4px solid #F79220; color: #595959; text-indent: 0em;\">代码示例：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<h4 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; color: black; font-size: 14px; font-weight: bold; text-align: left; margin: 20px 10px 0px 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"color: #595959;\">Step1：合并所有PDF文件</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fafafa; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #383a42; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fafafa; border-radius: 5px;\"><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;PdfMerger<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;定义PDF的文件夹路径</span><br>pdf_folder_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出'</span><br><br>output_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出汇总.pdf'</span><br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;获取文件夹中的所有PDF文件</span><br>pdf_files&nbsp;=&nbsp;[f&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;f&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;os.listdir(pdf_folder_path)&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">if</span>&nbsp;f.endswith(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">'.pdf'</span>)]<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;按序号排序文件</span><br>pdf_files.sort(key=<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">lambda</span>&nbsp;x:&nbsp;int(x.split(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">'_'</span>)[<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>]))<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;创建一个PdfMerger对象</span><br>merger&nbsp;=&nbsp;PdfMerger()<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;合并所有PDF文件</span><br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;pdf_file&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;pdf_files:<br>&nbsp;&nbsp;&nbsp;&nbsp;pdf_path&nbsp;=&nbsp;os.path.join(pdf_folder_path,&nbsp;pdf_file)<br>&nbsp;&nbsp;&nbsp;&nbsp;merger.append(pdf_path)<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;输出合并后的PDF文件</span><br>merger.write(output_path)<br>merger.close()<br><br>print(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">f\"合并后的PDF文件已保存到:&nbsp;<span class=\"hljs-subst\" style=\"color: #e45649; line-height: 26px;\">{output_path}</span>\"</span>)<br></code></pre> \n<h4 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; color: black; font-size: 14px; font-weight: bold; text-align: left; margin: 20px 10px 0px 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"color: #595959;\">Step2：按照总页数平均拆分为12个PDF</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fafafa; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #383a42; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fafafa; border-radius: 5px;\"><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;PdfReader,&nbsp;PdfWriter<br><br><span class=\"hljs-function\" style=\"line-height: 26px;\"><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">def</span>&nbsp;<span class=\"hljs-title\" style=\"color: #4078f2; line-height: 26px;\">split_pdf</span><span class=\"hljs-params\" style=\"line-height: 26px;\">(input_pdf_path,&nbsp;output_folder,&nbsp;num_splits)</span>:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;=&nbsp;PdfReader(input_pdf_path)<br>&nbsp;&nbsp;&nbsp;&nbsp;total_pages&nbsp;=&nbsp;len(reader.pages)<br>&nbsp;&nbsp;&nbsp;&nbsp;pages_per_split&nbsp;=&nbsp;total_pages&nbsp;//&nbsp;num_splits<br>&nbsp;&nbsp;&nbsp;&nbsp;extra_pages&nbsp;=&nbsp;total_pages&nbsp;%&nbsp;num_splits<br><br>&nbsp;&nbsp;&nbsp;&nbsp;start_page&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;i&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;range(num_splits):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer&nbsp;=&nbsp;PdfWriter()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_page&nbsp;=&nbsp;start_page&nbsp;+&nbsp;pages_per_split&nbsp;+&nbsp;(<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">1</span>&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">if</span>&nbsp;i&nbsp;&lt;&nbsp;extra_pages&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">else</span>&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;j&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;range(start_page,&nbsp;end_page):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.add_page(reader.pages[j])<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_pdf_path&nbsp;=&nbsp;os.path.join(output_folder,&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">f'科目明细账导出_<span class=\"hljs-subst\" style=\"color: #e45649; line-height: 26px;\">{i+<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">1</span>}</span>.pdf'</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">with</span>&nbsp;open(split_pdf_path,&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">'wb'</span>)&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">as</span>&nbsp;output_pdf:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.write(output_pdf)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page&nbsp;=&nbsp;end_page<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;定义输入PDF路径和输出文件夹路径</span><br>input_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r\"D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出汇总.pdf\"</span><br>output_folder&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分'</span><br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;确保输出文件夹存在</span><br>os.makedirs(output_folder,&nbsp;exist_ok=<span class=\"hljs-literal\" style=\"color: #0184bb; line-height: 26px;\">True</span>)<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;拆分PDF</span><br>split_pdf(input_pdf_path,&nbsp;output_folder,&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">12</span>)<br><br>print(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">\"PDF拆分完成\"</span>)<br></code></pre> \n<h4 data-tool=\"mdnice编辑器\" style=\"margin-top: 30px; margin-bottom: 15px; padding: 0px; color: black; font-size: 14px; font-weight: bold; text-align: left; margin: 20px 10px 0px 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"color: #595959;\">Step3：为12个PDF分别添加页码</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<blockquote class=\"multiquote-1\" data-tool=\"mdnice编辑器\" style=\"border: none; display: block; font-size: 0.9em; overflow: auto; overflow-scrolling: touch; padding-top: 10px; padding-bottom: 10px; padding-left: 20px; padding-right: 10px; margin-bottom: 20px; margin-top: 20px; margin: 10px 0px; border-left: 3px solid #f7bc44; border-right: 0px solid #f7bc44; color: #616161; quotes: none; background: #FBF9FD; padding: 0px 12px;\"> \n <p style=\"padding-top: 8px; padding-bottom: 8px; letter-spacing: 2px; word-spacing: 2px; margin: 0px; line-height: 26px; text-align: justify; color: #3e3e3e; font-size: 14px; text-indent: 0em;\">注：因为后续需要对明细账进行打印装订，每一本明细账首页需附<code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #595959;\">目录</code>，且第一本明细账还需在目录前附<code style=\"font-size: 14px; word-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0 2px; background-color: rgba(27,31,35,.05); font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; word-break: break-all; color: #595959;\">启用表</code>，故添加页码时需预留对应页码。</p> \n</blockquote> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #fafafa; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #383a42; display: -webkit-box; font-family: Operator Mono, Consolas, Monaco, Menlo, monospace; font-size: 12px; -webkit-overflow-scrolling: touch; padding-top: 15px; background: #fafafa; border-radius: 5px;\"><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;io<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;PdfReader,&nbsp;PdfWriter<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">from</span>&nbsp;reportlab.pdfgen&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;canvas<br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">from</span>&nbsp;reportlab.lib.pagesizes&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">import</span>&nbsp;A4<br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;定义PDF文件夹路径</span><br>input_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分\\明细账添加页码\\不含页码'</span><br>output_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分\\明细账添加页码\\含页码'</span><br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;获取横版A4页面尺寸</span><br>page_width,&nbsp;page_height&nbsp;=&nbsp;A4<br>page_width,&nbsp;page_height&nbsp;=&nbsp;page_height,&nbsp;page_width&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;交换宽度和高度</span><br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;设置页码位置为右上角</span><br>x&nbsp;=&nbsp;page_width&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">50</span>&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;右边距</span><br>y&nbsp;=&nbsp;page_height&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">50</span>&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;上边距</span><br><br>font_size&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">10</span><br><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;if&nbsp;filename.endswith('.pdf'):</span><br><span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filepath&nbsp;=&nbsp;os.path.join(directory,&nbsp;filename)</span><br><br><br>pdf_files&nbsp;=&nbsp;[f&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;f&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;os.listdir(input_pdf_path)&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">if</span>&nbsp;f.endswith(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">'.pdf'</span>)]<br>pdf_files.sort()&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;确保文件按顺序处理</span><br><br>current_page_number&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">1</span><br><span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;i,&nbsp;pdf_file&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;enumerate(pdf_files[<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>:]):<br>&nbsp;&nbsp;&nbsp;&nbsp;input_pdf&nbsp;=&nbsp;os.path.join(input_pdf_path,&nbsp;pdf_file)<br>&nbsp;&nbsp;&nbsp;&nbsp;output_pdf&nbsp;=&nbsp;os.path.join(output_pdf_path,&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">f'<span class=\"hljs-subst\" style=\"color: #e45649; line-height: 26px;\">{pdf_file.split(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">\".pdf\"</span>)[<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>]}</span>_含页码.pdf'</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">if</span>&nbsp;i&nbsp;==&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page_number&nbsp;=&nbsp;current_page_number&nbsp;+&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">else</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page_number&nbsp;=&nbsp;current_page_number&nbsp;+&nbsp;<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">1</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;=&nbsp;PdfReader(input_pdf)<br>&nbsp;&nbsp;&nbsp;&nbsp;writer&nbsp;=&nbsp;PdfWriter()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">for</span>&nbsp;i&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">in</span>&nbsp;range(len(reader.pages)):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packet&nbsp;=&nbsp;io.BytesIO()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;=&nbsp;canvas.Canvas(packet,&nbsp;pagesize=(page_width,&nbsp;page_height))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page_number&nbsp;=&nbsp;start_page_number&nbsp;+&nbsp;i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.setFont(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">\"Helvetica\"</span>,&nbsp;font_size)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #a0a1a7; font-style: italic; line-height: 26px;\">#&nbsp;can.drawString(x,&nbsp;y,&nbsp;\"{}/{}\".format(page_number,&nbsp;len(reader.pages)))</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.drawString(x,&nbsp;y,&nbsp;str(page_number))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.save()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packet.seek(<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_pdf&nbsp;=&nbsp;PdfReader(packet)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;reader.pages[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page.merge_page(new_pdf.pages[<span class=\"hljs-number\" style=\"color: #986801; line-height: 26px;\">0</span>])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.add_page(page)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">with</span>&nbsp;open(output_pdf,&nbsp;<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">'wb'</span>)&nbsp;<span class=\"hljs-keyword\" style=\"color: #a626a4; line-height: 26px;\">as</span>&nbsp;output_pdf:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.write(output_pdf)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;print(<span class=\"hljs-string\" style=\"color: #50a14f; line-height: 26px;\">f\"文件：<span class=\"hljs-subst\" style=\"color: #e45649; line-height: 26px;\">{input_pdf}</span>&nbsp;添加页码完成\"</span>)<br></code></pre>",
                "title": "Python案例 | 自动化办公：PDF批量合并、拆分以及添加页码",
                "categoryId": 1,
                "categoryName": "后端",
                "tagId": 103,
                "tagName": "Python",
                "userId": 15248,
                "userOutId": "556994507988",
                "username": "及吾无身",
                "avatar": "https://files.mdnice.com/user/15248/user-avatar/24afa0da-4c74-4717-b5bc-b9b19cc0f858.jpg",
                "description": "需求场景：从财务系统中导出了上千份关于不同科目的明细账PDF文件，现在需要将其合并为一个PDF文件备查，接着再按照页码平均拆分为12个PDF文件，并为每一个PDF文件添加页码。模块安装：!&nbsp;",
                "level": 1,
                "publishTime": "2024/10/28",
                "readingNum": 17,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "7fa0fcc5bb7d43ffba0b6a1f252e7192",
                    "name": "默认专栏",
                    "briefIntro": "这是一个默认专栏",
                    "cover": "https://files.mdnice.com/common/community/default-column-cover.jpg",
                    "writingNum": 7,
                    "createTime": "2024-08-06 19:07"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "60d3cf81fc5f4092a98559755c386f73"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}