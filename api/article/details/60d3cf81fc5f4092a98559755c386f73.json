{
    "props": {
        "pageProps": {
            "query": {
                "id": "60d3cf81fc5f4092a98559755c386f73"
            },
            "ieBrowser": false,
            "needRefresh": false,
            "writingDetail": {
                "id": 85680,
                "outId": "60d3cf81fc5f4092a98559755c386f73",
                "articleOutId": "60d3cf81fc5f4092a98559755c386f73",
                "html": "<hr data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; background-attachment: scroll; background-clip: border-box; background-color: rgba(0, 0, 0, 0); background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-right-width: initial; border-bottom-width: initial; border-left-width: initial; border-right-style: none; border-bottom-style: none; border-left-style: none; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; border-top-width: 1.2px; border-top-style: dashed; border-top-color: rgb(244, 164, 96);\"> \n<figure data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: flex; flex-direction: column; justify-content: center; align-items: center;\"> \n <img src=\"https://files.mdnice.com/pic/3ea9c516-1e4c-4a95-8a89-0b1b75272464.png\" alt style=\"display: block; margin-top: 20px; margin-right: auto; margin-bottom: 20px; margin-left: auto; max-width: 100%; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; object-fit: fill; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px;\"> \n</figure> \n<hr data-tool=\"mdnice编辑器\" style=\"margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; background-attachment: scroll; background-clip: border-box; background-color: rgba(0, 0, 0, 0); background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: 0px; padding-top: 0px; padding-right: 0px; padding-bottom: 0px; padding-left: 0px; border-right-width: initial; border-bottom-width: initial; border-left-width: initial; border-right-style: none; border-bottom-style: none; border-left-style: none; border-right-color: initial; border-bottom-color: initial; border-left-color: initial; border-image-source: initial; border-image-slice: initial; border-image-width: initial; border-image-outset: initial; border-image-repeat: initial; border-top-width: 1.2px; border-top-style: dashed; border-top-color: rgb(244, 164, 96);\"> \n<h3 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: inline-block; padding-left: 10px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(247, 146, 32); text-indent: 0em;\">需求场景：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<p data-tool=\"mdnice编辑器\" style=\"color: rgb(89, 89, 89); font-size: 14px; line-height: 1.8em; letter-spacing: 2px; text-align: left; text-indent: 2em; padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px; margin-top: 1px; margin-right: 1px; margin-bottom: 0px; margin-left: 0px; word-spacing: 2px;\">从财务系统中导出了上千份关于不同科目的明细账PDF文件，现在需要将其合并为一个PDF文件备查，接着再按照页码平均拆分为12个PDF文件，并为每一个PDF文件添加页码。</p> \n<h3 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: inline-block; padding-left: 10px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(247, 146, 32); text-indent: 0em;\">模块安装：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\">!&nbsp;pip&nbsp;install&nbsp;PyPDF2&nbsp;reportlab&nbsp;io<br></code></pre> \n<h3 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 0px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 16px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: inline-block; padding-left: 10px; border-left-width: 4px; border-left-style: solid; border-left-color: rgb(247, 146, 32); text-indent: 0em;\">代码示例：</span><span class=\"suffix\" style=\"display: none;\"></span></h3> \n<h4 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; font-size: 14px; font-weight: bold; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 18px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">Step1：合并所有PDF文件</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;PdfMerger<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;定义PDF的文件夹路径</span><br>pdf_folder_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出'</span><br><br>output_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出汇总.pdf'</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;获取文件夹中的所有PDF文件</span><br>pdf_files&nbsp;=&nbsp;[f&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;f&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;os.listdir(pdf_folder_path)&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;f.endswith(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'.pdf'</span>)]<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;按序号排序文件</span><br>pdf_files.sort(key=<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">lambda</span>&nbsp;x:&nbsp;int(x.split(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'_'</span>)[<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>]))<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;创建一个PdfMerger对象</span><br>merger&nbsp;=&nbsp;PdfMerger()<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;合并所有PDF文件</span><br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;pdf_file&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;pdf_files:<br>&nbsp;&nbsp;&nbsp;&nbsp;pdf_path&nbsp;=&nbsp;os.path.join(pdf_folder_path,&nbsp;pdf_file)<br>&nbsp;&nbsp;&nbsp;&nbsp;merger.append(pdf_path)<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;输出合并后的PDF文件</span><br>merger.write(output_path)<br>merger.close()<br><br>print(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">f\"合并后的PDF文件已保存到:&nbsp;<span class=\"hljs-subst\" style=\"color: #e06c75; line-height: 26px;\">{output_path}</span>\"</span>)<br></code></pre> \n<h4 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; font-size: 14px; font-weight: bold; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 18px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">Step2：按照总页数平均拆分为12个PDF</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;PdfReader,&nbsp;PdfWriter<br><br><span class=\"hljs-function\" style=\"line-height: 26px;\"><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">def</span>&nbsp;<span class=\"hljs-title\" style=\"color: #61aeee; line-height: 26px;\">split_pdf</span><span class=\"hljs-params\" style=\"line-height: 26px;\">(input_pdf_path,&nbsp;output_folder,&nbsp;num_splits)</span>:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;=&nbsp;PdfReader(input_pdf_path)<br>&nbsp;&nbsp;&nbsp;&nbsp;total_pages&nbsp;=&nbsp;len(reader.pages)<br>&nbsp;&nbsp;&nbsp;&nbsp;pages_per_split&nbsp;=&nbsp;total_pages&nbsp;//&nbsp;num_splits<br>&nbsp;&nbsp;&nbsp;&nbsp;extra_pages&nbsp;=&nbsp;total_pages&nbsp;%&nbsp;num_splits<br><br>&nbsp;&nbsp;&nbsp;&nbsp;start_page&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;i&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;range(num_splits):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer&nbsp;=&nbsp;PdfWriter()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end_page&nbsp;=&nbsp;start_page&nbsp;+&nbsp;pages_per_split&nbsp;+&nbsp;(<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">1</span>&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;i&nbsp;&lt;&nbsp;extra_pages&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">else</span>&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;j&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;range(start_page,&nbsp;end_page):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.add_page(reader.pages[j])<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;split_pdf_path&nbsp;=&nbsp;os.path.join(output_folder,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">f'科目明细账导出_<span class=\"hljs-subst\" style=\"color: #e06c75; line-height: 26px;\">{i+<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">1</span>}</span>.pdf'</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">with</span>&nbsp;open(split_pdf_path,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'wb'</span>)&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">as</span>&nbsp;output_pdf:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.write(output_pdf)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page&nbsp;=&nbsp;end_page<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;定义输入PDF路径和输出文件夹路径</span><br>input_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r\"D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账导出汇总.pdf\"</span><br>output_folder&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分'</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;确保输出文件夹存在</span><br>os.makedirs(output_folder,&nbsp;exist_ok=<span class=\"hljs-literal\" style=\"color: #56b6c2; line-height: 26px;\">True</span>)<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;拆分PDF</span><br>split_pdf(input_pdf_path,&nbsp;output_folder,&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">12</span>)<br><br>print(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"PDF拆分完成\"</span>)<br></code></pre> \n<h4 data-tool=\"mdnice编辑器\" style=\"padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; display: block; font-size: 14px; font-weight: bold; text-align: left; margin-top: 20px; margin-right: 10px; margin-bottom: 0px; margin-left: 15px;\"><span class=\"prefix\" style=\"display: none;\"></span><span class=\"content\" style=\"font-size: 18px; color: rgb(89, 89, 89); line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: bold; display: block;\">Step3：为12个PDF分别添加页码</span><span class=\"suffix\" style=\"display: none;\"></span></h4> \n<blockquote class=\"multiquote-1\" data-tool=\"mdnice编辑器\" style=\"border-top-style: none; border-bottom-style: none; border-top-width: 3px; border-bottom-width: 3px; border-top-color: rgba(0, 0, 0, 0.4); border-bottom-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; width: auto; height: auto; box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px; display: block; overflow-x: auto; overflow-y: auto; margin-top: 10px; margin-right: 0px; margin-bottom: 10px; margin-left: 0px; border-left-width: 3px; border-left-style: solid; border-left-color: rgb(247, 188, 68); border-right-width: 0px; border-right-style: solid; border-right-color: rgb(247, 188, 68); color: rgb(97, 97, 97); quotes: none; background-image: initial; background-position-x: initial; background-position-y: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: rgb(251, 249, 253); padding-top: 0px; padding-right: 12px; padding-bottom: 0px; padding-left: 12px;\"> <span style=\"display: none; color: rgb(0, 0, 0); font-size: 16px; line-height: 1.5em; letter-spacing: 0em; text-align: left; font-weight: normal;\"></span> \n <p style=\"padding-top: 8px; padding-bottom: 8px; padding-left: 0px; padding-right: 0px; word-spacing: 2px; letter-spacing: 0em; font-weight: normal; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; line-height: 26px; text-align: justify; color: rgb(62, 62, 62); font-size: 14px; text-indent: 0em;\">注：因为后续需要对明细账进行打印装订，每一本明细账首页需附<code style=\"font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-color: rgba(27, 31, 35, 0.05); background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; margin-top: 0px; margin-bottom: 0px; margin-left: 2px; margin-right: 2px; padding-top: 2px; padding-bottom: 2px; padding-left: 4px; padding-right: 4px; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgb(0, 0, 0); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow-wrap: break-word; font-family: Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(89, 89, 89);\">目录</code>，且第一本明细账还需在目录前附<code style=\"font-size: 14px; line-height: 1.8em; letter-spacing: 0em; background-attachment: scroll; background-clip: border-box; background-color: rgba(27, 31, 35, 0.05); background-image: none; background-origin: padding-box; background-position-x: 0%; background-position-y: 0%; background-repeat: no-repeat; background-size: auto; width: auto; height: auto; margin-top: 0px; margin-bottom: 0px; margin-left: 2px; margin-right: 2px; padding-top: 2px; padding-bottom: 2px; padding-left: 4px; padding-right: 4px; border-top-style: none; border-bottom-style: none; border-left-style: none; border-right-style: none; border-top-width: 3px; border-bottom-width: 3px; border-left-width: 3px; border-right-width: 3px; border-top-color: rgb(0, 0, 0); border-bottom-color: rgba(0, 0, 0, 0.4); border-left-color: rgba(0, 0, 0, 0.4); border-right-color: rgba(0, 0, 0, 0.4); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; overflow-wrap: break-word; font-family: Consolas, Monaco, Menlo, monospace; word-break: break-all; color: rgb(89, 89, 89);\">启用表</code>，故添加页码时需预留对应页码。</p> \n</blockquote> \n<pre class=\"custom\" data-tool=\"mdnice编辑器\" style=\"border-radius: 5px; box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px; text-align: left; margin-top: 10px; margin-bottom: 10px; margin-left: 0px; margin-right: 0px; padding-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px;\"><span style=\"display: block; background: url(https://files.mdnice.com/user/3441/876cad08-0422-409d-bb5a-08afec5da8ee.svg); height: 30px; width: 100%; background-size: 40px; background-repeat: no-repeat; background-color: #282c34; margin-bottom: -7px; border-radius: 5px; background-position: 10px 10px;\"></span><code class=\"hljs\" style=\"overflow-x: auto; padding: 16px; color: #abb2bf; padding-top: 15px; background: #282c34; border-radius: 5px; display: -webkit-box; font-family: Consolas, Monaco, Menlo, monospace; font-size: 12px;\"><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;os<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;io<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">from</span>&nbsp;PyPDF2&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;PdfReader,&nbsp;PdfWriter<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">from</span>&nbsp;reportlab.pdfgen&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;canvas<br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">from</span>&nbsp;reportlab.lib.pagesizes&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">import</span>&nbsp;A4<br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;定义PDF文件夹路径</span><br>input_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分\\明细账添加页码\\不含页码'</span><br>output_pdf_path&nbsp;=&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">r'D:\\Users\\yxj\\Desktop\\dev\\output\\科目明细账拆分\\明细账添加页码\\含页码'</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;获取横版A4页面尺寸</span><br>page_width,&nbsp;page_height&nbsp;=&nbsp;A4<br>page_width,&nbsp;page_height&nbsp;=&nbsp;page_height,&nbsp;page_width&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;交换宽度和高度</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;设置页码位置为右上角</span><br>x&nbsp;=&nbsp;page_width&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">50</span>&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;右边距</span><br>y&nbsp;=&nbsp;page_height&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">50</span>&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;上边距</span><br><br>font_size&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">10</span><br><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;if&nbsp;filename.endswith('.pdf'):</span><br><span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filepath&nbsp;=&nbsp;os.path.join(directory,&nbsp;filename)</span><br><br><br>pdf_files&nbsp;=&nbsp;[f&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;f&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;os.listdir(input_pdf_path)&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;f.endswith(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'.pdf'</span>)]<br>pdf_files.sort()&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;确保文件按顺序处理</span><br><br>current_page_number&nbsp;=&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">1</span><br><span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;i,&nbsp;pdf_file&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;enumerate(pdf_files[<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>:]):<br>&nbsp;&nbsp;&nbsp;&nbsp;input_pdf&nbsp;=&nbsp;os.path.join(input_pdf_path,&nbsp;pdf_file)<br>&nbsp;&nbsp;&nbsp;&nbsp;output_pdf&nbsp;=&nbsp;os.path.join(output_pdf_path,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">f'<span class=\"hljs-subst\" style=\"color: #e06c75; line-height: 26px;\">{pdf_file.split(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\".pdf\"</span>)[<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>]}</span>_含页码.pdf'</span>)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">if</span>&nbsp;i&nbsp;==&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page_number&nbsp;=&nbsp;current_page_number&nbsp;+&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">2</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">else</span>:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start_page_number&nbsp;=&nbsp;current_page_number&nbsp;+&nbsp;<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">1</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;reader&nbsp;=&nbsp;PdfReader(input_pdf)<br>&nbsp;&nbsp;&nbsp;&nbsp;writer&nbsp;=&nbsp;PdfWriter()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">for</span>&nbsp;i&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">in</span>&nbsp;range(len(reader.pages)):<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packet&nbsp;=&nbsp;io.BytesIO()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;=&nbsp;canvas.Canvas(packet,&nbsp;pagesize=(page_width,&nbsp;page_height))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page_number&nbsp;=&nbsp;start_page_number&nbsp;+&nbsp;i<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.setFont(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">\"Helvetica\"</span>,&nbsp;font_size)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"color: #5c6370; font-style: italic; line-height: 26px;\">#&nbsp;can.drawString(x,&nbsp;y,&nbsp;\"{}/{}\".format(page_number,&nbsp;len(reader.pages)))</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.drawString(x,&nbsp;y,&nbsp;str(page_number))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can.save()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packet.seek(<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new_pdf&nbsp;=&nbsp;PdfReader(packet)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;reader.pages[i]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page.merge_page(new_pdf.pages[<span class=\"hljs-number\" style=\"color: #d19a66; line-height: 26px;\">0</span>])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.add_page(page)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">with</span>&nbsp;open(output_pdf,&nbsp;<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">'wb'</span>)&nbsp;<span class=\"hljs-keyword\" style=\"color: #c678dd; line-height: 26px;\">as</span>&nbsp;output_pdf:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.write(output_pdf)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;print(<span class=\"hljs-string\" style=\"color: #98c379; line-height: 26px;\">f\"文件：<span class=\"hljs-subst\" style=\"color: #e06c75; line-height: 26px;\">{input_pdf}</span>&nbsp;添加页码完成\"</span>)<br></code></pre>",
                "title": "Python案例 | 自动化办公：批量合并多个PDF",
                "categoryId": 1,
                "categoryName": "后端",
                "tagId": 100,
                "tagName": "后端",
                "userId": 15248,
                "userOutId": "556994507988",
                "username": "及吾无身",
                "avatar": "https://files.mdnice.com/user/15248/user-avatar/24afa0da-4c74-4717-b5bc-b9b19cc0f858.jpg",
                "description": "需求场景：从财务系统中导出了上千份关于不同科目的明细账PDF文件，现在需要将其合并为一个PDF文件备查，接着再按照页码平均拆分为12个PDF文件，并为每一个PDF文件添加页码。模块安装：!&nbsp;",
                "level": 1,
                "publishTime": "2024/10/27",
                "readingNum": 10,
                "likeNum": 0,
                "introduction": null,
                "followWords": null,
                "followPic": null,
                "isFollowing": false,
                "isLike": false,
                "isSelf": false,
                "type": 1,
                "isVisible": true,
                "invisibleReason": null,
                "writingColumn": {
                    "columnOutId": "6d35171636174a0d96f3b93cb923d46d",
                    "name": "Python职场实战",
                    "briefIntro": "Python职场实战",
                    "cover": "https://files.mdnice.com/user/15248/column-cover/4eff7619-ea25-4cbd-8020-ec830500c6c1.png",
                    "writingNum": 1,
                    "createTime": "2024-10-27 23:31"
                }
            }
        },
        "__N_SSP": true
    },
    "page": "/writing/[id]",
    "query": {
        "id": "60d3cf81fc5f4092a98559755c386f73"
    },
    "buildId": "ErZPkD4oq6iwH2nj6Dpcx",
    "isFallback": false,
    "gssp": true,
    "appGip": true
}